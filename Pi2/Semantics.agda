{-# OPTIONS --without-K --allow-unsolved-metas #-}

module Pi2.Semantics where

open import UnivalentTypeTheory
open import TwoUniverse as M
open import Pi2.Syntax as S

------------------------------------------------------------------------------
-- Soundness: mapping syntax to the model

âŸ¦_âŸ§ : U â†’ U[ğŸš]
âŸ¦ `ğŸš âŸ§ = M.`ğŸš

âŸ¦_âŸ§â‚ : {A B : U} â†’ A âŸ·â‚ B â†’ âŸ¦ A âŸ§ == âŸ¦ B âŸ§
âŸ¦_âŸ§â‚ {`ğŸš} {`ğŸš} `id = M.`id
âŸ¦_âŸ§â‚ {`ğŸš} {`ğŸš} `not = M.`not
âŸ¦_âŸ§â‚ {`ğŸš} {`ğŸš} (!â‚ p) = ! âŸ¦ p âŸ§â‚
âŸ¦_âŸ§â‚ {`ğŸš} {`ğŸš} (p â—¾â‚ q) = âŸ¦ p âŸ§â‚ â—¾ âŸ¦ q âŸ§â‚

-- Why?
âŸ¦!_âŸ§â‚â‰¡ : {A B : U} â†’ (p : A âŸ·â‚ B) â†’ âŸ¦ !â‚ p âŸ§â‚ == ! âŸ¦ p âŸ§â‚
âŸ¦! p âŸ§â‚â‰¡  = {!!}

âŸ¦_â—¾_âŸ§â‚â‰¡ : {A B C : U} â†’ (p : A âŸ·â‚ B) (q : B âŸ·â‚ C)â†’ âŸ¦ p â—¾â‚ q âŸ§â‚ == âŸ¦ p âŸ§â‚ â—¾ âŸ¦ q âŸ§â‚
âŸ¦ p â—¾ q âŸ§â‚â‰¡ = {!!}

âŸ¦_âŸ§â‚‚ : {A B : U} {p q : A âŸ·â‚ B} â†’ (u : p âŸ·â‚‚ q) â†’ âŸ¦ p âŸ§â‚ == âŸ¦ q âŸ§â‚
âŸ¦_âŸ§â‚‚ {U.`ğŸš} {U.`ğŸš} {p} `idâ‚‚ = refl âŸ¦ p âŸ§â‚
âŸ¦_âŸ§â‚‚ {U.`ğŸš} {U.`ğŸš} (`idl p) = â—¾unitl âŸ¦ p âŸ§â‚
âŸ¦_âŸ§â‚‚ {U.`ğŸš} {U.`ğŸš} (`idr p) = â—¾unitr âŸ¦ p âŸ§â‚
âŸ¦_âŸ§â‚‚ {U.`ğŸš} {U.`ğŸš} (`!l p) = (ap (Î» x â†’ âŸ¦ p âŸ§â‚ â—¾ x) âŸ¦! p âŸ§â‚â‰¡) â—¾ â—¾invr âŸ¦ p âŸ§â‚ â—¾ refl (refl M.`ğŸš)
âŸ¦_âŸ§â‚‚ {U.`ğŸš} {U.`ğŸš} (`!r p) = (ap (Î» x â†’ x â—¾ âŸ¦ p âŸ§â‚) âŸ¦! p âŸ§â‚â‰¡) â—¾ â—¾invl âŸ¦ p âŸ§â‚ â—¾ refl (refl M.`ğŸš)
âŸ¦_âŸ§â‚‚ {U.`ğŸš} {U.`ğŸš} `!id = refl (refl M.`ğŸš)
âŸ¦_âŸ§â‚‚ {U.`ğŸš} {U.`ğŸš} `!not = {!!}
âŸ¦_âŸ§â‚‚ {U.`ğŸš} {U.`ğŸš} (`!â—¾ {A} {B} {C} {p} {q}) =
     (!â—¾ _ _) â—¾ (ap (Î» x â†’ x â—¾ ! âŸ¦ p âŸ§â‚) (! âŸ¦! q âŸ§â‚â‰¡)) â—¾ (ap (Î» x â†’ âŸ¦ !â‚ q âŸ§â‚ â—¾ x) (! âŸ¦! p âŸ§â‚â‰¡))
âŸ¦_âŸ§â‚‚ {U.`ğŸš} {U.`ğŸš} `!! = !! _
âŸ¦_âŸ§â‚‚ {U.`ğŸš} {U.`ğŸš} (`assoc p q r) =
     (ap (Î» x â†’ x â—¾ âŸ¦ r âŸ§â‚) âŸ¦ p â—¾ q âŸ§â‚â‰¡) â—¾ â—¾assoc âŸ¦ p âŸ§â‚ âŸ¦ q âŸ§â‚ âŸ¦ r âŸ§â‚ â—¾ (ap (Î» x â†’ âŸ¦ p âŸ§â‚ â—¾ x) (! âŸ¦ q â—¾ r âŸ§â‚â‰¡))
âŸ¦_âŸ§â‚‚ {U.`ğŸš} {U.`ğŸš} (!â‚‚ u) = ! âŸ¦ u âŸ§â‚‚
âŸ¦_âŸ§â‚‚ {U.`ğŸš} {U.`ğŸš} (_â—¾â‚‚_ u v) = âŸ¦ u âŸ§â‚‚ â—¾ âŸ¦ v âŸ§â‚‚
âŸ¦_âŸ§â‚‚ {U.`ğŸš} {U.`ğŸš} (_â–¡â‚‚_ {A} {B} {C} {p} {q} {r} {s} {u} {v}) =
     (ap (Î» x â†’ x â—¾ âŸ¦ r âŸ§â‚) âŸ¦ u âŸ§â‚‚) â—¾ ((ap (Î» x â†’ âŸ¦ q âŸ§â‚ â—¾ x) âŸ¦ v âŸ§â‚‚))

{--
âŸ¦-âŸ§â‚-resp-idl : {A B : U} {p : A âŸ·â‚ B} â†’ âŸ¦ S.`id â—¾â‚ p âŸ§â‚ == âŸ¦ p âŸ§â‚
âŸ¦-âŸ§â‚-resp-idl {p = `id} = {!!}
âŸ¦-âŸ§â‚-resp-idl {p = `not} = {!!}
âŸ¦-âŸ§â‚-resp-idl {p = !â‚ p} = {!!}
âŸ¦-âŸ§â‚-resp-idl {p = p â—¾â‚ q} = {!!}

âŸ¦-âŸ§â‚-resp-idr : {A B : U} {p : A âŸ·â‚ B} â†’ âŸ¦ p â—¾â‚ S.`id âŸ§â‚ == âŸ¦ p âŸ§â‚
âŸ¦-âŸ§â‚-resp-idr {p = `id} = {!!}
âŸ¦-âŸ§â‚-resp-idr {p = `not} = {!!}
âŸ¦-âŸ§â‚-resp-idr {p = !â‚ p} = {!!}
âŸ¦-âŸ§â‚-resp-idr {p = p â—¾â‚ q} = {!!}

âŸ¦-âŸ§â‚-resp-â—¾ : {A B C : U} {p : A âŸ·â‚ B} {q : B âŸ·â‚ C} â†’ âŸ¦ p â—¾â‚ q âŸ§â‚ == âŸ¦ p âŸ§â‚ â—¾ âŸ¦ q âŸ§â‚
âŸ¦-âŸ§â‚-resp-â—¾ = {!!}
--}

------------------------------------------------------------------------------
-- Completeness: mapping the model to syntax

quoteâ‚€ : U[ğŸš] â†’ U
quoteâ‚€ _ = U.`ğŸš

quoteâ‚ : {A B : U} â†’ âŸ¦ A âŸ§ == âŸ¦ B âŸ§ â†’ A âŸ·â‚ B
quoteâ‚ eq = {!!}

quoteâ‚‚ : {A B : U} {p q : A âŸ·â‚ B} â†’ âŸ¦ p âŸ§â‚ == âŸ¦ q âŸ§â‚ â†’ (p âŸ·â‚‚ q)
quoteâ‚‚ eqâ‚‚ = {!!}

------------------------------------------------------------------------------
-- Normalization by evaluation a la Altenkirch

canonicalâ‚ : {A B : U} â†’ (p : A âŸ·â‚ B) â†’ (A âŸ·â‚ B)
canonicalâ‚ p = quoteâ‚ âŸ¦ p âŸ§â‚

inversionâ‚ : {A B : U} â†’ (p : A âŸ·â‚ B) â†’ canonicalâ‚ p âŸ·â‚‚ p
inversionâ‚ u = {!!}

completenessâ‚ : {A B : U} {p q : A âŸ·â‚ B} â†’ âŸ¦ p âŸ§â‚ == âŸ¦ q âŸ§â‚ â†’ p âŸ·â‚‚ q
completenessâ‚ {p = p} {q = q} u = {!!}
{--
p <=> canonical p <=> canonical q <=> q
--}

------------------------------------------------------------------------------
