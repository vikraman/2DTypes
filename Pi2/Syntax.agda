{-# OPTIONS --without-K --allow-unsolved-metas #-}

module Pi2.Syntax where

open import Data.Bool

infix 3 _‚ü∑‚ÇÅ_ _‚ü∑‚ÇÇ_ _‚ü∑‚ÇÉ_
infix 5 !‚ÇÅ_ !‚ÇÇ_
infix 4 _‚äô‚ÇÅ_ _‚äô‚ÇÇ_

------------------------------------------------------------------------------
-- Objects

data U : Set where

  `ùüö : ----
        U

------------------------------------------------------------------------------
-- 1-paths

data _‚ü∑‚ÇÅ_ : U ‚Üí U ‚Üí Set where

  `id : {A : U} ‚Üí
        -----------
        A ‚ü∑‚ÇÅ A

  `not : -----------
        `ùüö ‚ü∑‚ÇÅ `ùüö

  !‚ÇÅ_ : {A B : U} ‚Üí (p : A ‚ü∑‚ÇÅ B)
      ----------------------------
      ‚Üí (B ‚ü∑‚ÇÅ A)

  _‚äô‚ÇÅ_ : {A B C : U} ‚Üí (p : A ‚ü∑‚ÇÅ B) (q : B ‚ü∑‚ÇÅ C)
        --------------------------------------------
        ‚Üí (A ‚ü∑‚ÇÅ C)

------------------------------------------------------------------------------
-- 2-paths

data _‚ü∑‚ÇÇ_ : {A B : U} (p q : A ‚ü∑‚ÇÅ B) ‚Üí Set where

  `id‚ÇÇ : {A B : U} {p : A ‚ü∑‚ÇÅ B} ‚Üí
         -------------------------
         p ‚ü∑‚ÇÇ p

  `idl     : {A B : U} (p : A ‚ü∑‚ÇÅ B)
           ----------------------
           ‚Üí `id ‚äô‚ÇÅ p ‚ü∑‚ÇÇ p

  `idr     : {A B : U} (p : A ‚ü∑‚ÇÅ B)
           ----------------------
           ‚Üí p ‚äô‚ÇÅ `id ‚ü∑‚ÇÇ p

  `!l      : {A B : U} (p : A ‚ü∑‚ÇÅ B)
           ----------------------
           ‚Üí p ‚äô‚ÇÅ !‚ÇÅ p ‚ü∑‚ÇÇ `id

  `!r      : {A B : U} (p : B ‚ü∑‚ÇÅ A)
           ----------------------
           ‚Üí !‚ÇÅ p ‚äô‚ÇÅ p ‚ü∑‚ÇÇ `id

  `!id    : {A : U} ‚Üí
           -----------------------
           !‚ÇÅ `id {A} ‚ü∑‚ÇÇ `id {A}

  `!not    :
           ----------------------
           !‚ÇÅ `not ‚ü∑‚ÇÇ `not

  `!‚óæ   : {A B C : U} {p : A ‚ü∑‚ÇÅ B} {q : B ‚ü∑‚ÇÅ C}
           -----------------------------------------
           ‚Üí !‚ÇÅ (p ‚äô‚ÇÅ q) ‚ü∑‚ÇÇ (!‚ÇÅ q) ‚äô‚ÇÅ (!‚ÇÅ p)

  `!!   : {A B : U} {p : A ‚ü∑‚ÇÅ B}
           -----------------------------------------
           ‚Üí !‚ÇÅ (!‚ÇÅ p) ‚ü∑‚ÇÇ p

  `assoc   : {A B C D : U} (p : A ‚ü∑‚ÇÅ B) (q : B ‚ü∑‚ÇÅ C) (r : C ‚ü∑‚ÇÅ D)
           ---------------------------------------------------------
           ‚Üí (p ‚äô‚ÇÅ q) ‚äô‚ÇÅ r ‚ü∑‚ÇÇ p ‚äô‚ÇÅ (q ‚äô‚ÇÅ r)

  `!       : {A B : U} {p q : A ‚ü∑‚ÇÅ B}
           ‚Üí p ‚ü∑‚ÇÇ q
           ---------------------------
           ‚Üí !‚ÇÅ p ‚ü∑‚ÇÇ !‚ÇÅ q

  !‚ÇÇ_      : {A B : U} {p q : A ‚ü∑‚ÇÅ B}
           ‚Üí (u : p ‚ü∑‚ÇÇ q)
           --------------------------
           ‚Üí q ‚ü∑‚ÇÇ p

  _‚äô‚ÇÇ_   : {A B : U} {p q r : A ‚ü∑‚ÇÅ B}
          ‚Üí (u : p ‚ü∑‚ÇÇ q) (v : q ‚ü∑‚ÇÇ r)
          --------------------------------
          ‚Üí (p ‚ü∑‚ÇÇ r)

  _‚ñ°‚ÇÇ_ : {A B C : U} {p q : A ‚ü∑‚ÇÅ B} {r s : B ‚ü∑‚ÇÅ C} (u : p ‚ü∑‚ÇÇ q) (v : r ‚ü∑‚ÇÇ s)
         --------------------------------------------------------------------------
         ‚Üí (p ‚äô‚ÇÅ r) ‚ü∑‚ÇÇ (q ‚äô‚ÇÅ s)

------------------------------------------------------------------------------
-- n+3-paths for n ‚â• 0

data _‚ü∑‚ÇÉ_ {A B : U} {p q : A ‚ü∑‚ÇÅ B} (u v : p ‚ü∑‚ÇÇ q) : Set where

  `trunc : --------
           u ‚ü∑‚ÇÉ v

------------------------------------------------------------------------------
-- Op Semantics

El : U ‚Üí Set
El `ùüö = Bool

evalF : {A B : U} ‚Üí (c : A ‚ü∑‚ÇÅ B) ‚Üí El A ‚Üí El B
evalB : {A B : U} ‚Üí (c : A ‚ü∑‚ÇÅ B) ‚Üí El B ‚Üí El A

evalF `id v = v
evalF `not false = true
evalF `not true = false
evalF (!‚ÇÅ c) v = evalB c v
evalF (c‚ÇÅ ‚äô‚ÇÅ c‚ÇÇ) v = evalF c‚ÇÇ (evalF c‚ÇÅ v)

evalB `id v = v
evalB `not false = true
evalB `not true = false
evalB (!‚ÇÅ c) v = evalF c v
evalB (c‚ÇÅ ‚äô‚ÇÅ c‚ÇÇ) v = evalB c‚ÇÅ (evalB c‚ÇÇ v)

eval2F : {A B : U} {p q : A ‚ü∑‚ÇÅ B} ‚Üí (u : p ‚ü∑‚ÇÇ q) ‚Üí (El A ‚Üí El B) ‚Üí (El A ‚Üí El B)
eval2F `id‚ÇÇ f = f
eval2F (`idl p) f = f
eval2F (`idr p) f = f
eval2F (`!l p) f = {!!}
eval2F (`!r p) f = {!!}
eval2F `!id f = {!!}
eval2F `!not f = {!!}
eval2F `!‚óæ f = {!!}
eval2F `!! f = {!!}
eval2F (`assoc p q r) f = {!!}
eval2F (`! u) f = {!!}
eval2F (!‚ÇÇ u) f = {!!}
eval2F (u ‚äô‚ÇÇ u‚ÇÅ) f = {!!}
eval2F (u ‚ñ°‚ÇÇ u‚ÇÅ) f = {!!}

-- and so on and so forth??  Now the big question is how to connect this to the
-- model One idea is: evalF c v = w means that one of the fibers of path ‚ü¶ c ‚üß
-- starts at v and ends at w ????????

------------------------------------------------------------------------------
module Tests where

  !!‚ÇÇ : {A B : U} {p q : A ‚ü∑‚ÇÅ B} (u : p ‚ü∑‚ÇÇ q) ‚Üí !‚ÇÇ !‚ÇÇ u ‚ü∑‚ÇÉ u
  !!‚ÇÇ u = `trunc

  ‚óæ‚ÇÇ-assoc : {A B : U} {p q r s : A ‚ü∑‚ÇÅ B}
           ‚Üí (u : p ‚ü∑‚ÇÇ q) (v : q ‚ü∑‚ÇÇ r) (w : r ‚ü∑‚ÇÇ s)
           ‚Üí (u ‚äô‚ÇÇ v) ‚äô‚ÇÇ w ‚ü∑‚ÇÉ u ‚äô‚ÇÇ (v ‚äô‚ÇÇ w)
  ‚óæ‚ÇÇ-assoc u v w = `trunc

------------------------------------------------------------------------------

not‚óænot‚áîid : `not ‚äô‚ÇÅ `not ‚ü∑‚ÇÇ `id
not‚óænot‚áîid = ((!‚ÇÇ `!not) ‚ñ°‚ÇÇ `id‚ÇÇ) ‚äô‚ÇÇ (`!r _‚ü∑‚ÇÅ_.`not)
