{-# OPTIONS --without-K --exact-split --rewriting --overlapping-instances #-}

open import HoTT hiding (_<_ ; ltS ; ltSR ; _+_ ; _√ó_)
import lib.types.Nat as N
import lib.types.Sigma as S

open import Pi+.UFin.BAut
open import Pi+.Misc
open import Pi+.Extra

open import Pi+.Indexed.Syntax as Pi+
open import Pi+.Indexed.SyntaxHat as Pi^
open import Pi+.Indexed.SyntaxHatHelpers as Pi^
open import Pi+.Indexed.SyntaxFull as Pi
open import Pi+.Indexed.Translation
import Pi+.Indexed.Equiv1 as Pi+
import Pi+.Indexed.Equiv0Hat as Pi^
import Pi+.Indexed.Equiv1Hat as Pi^
import Pi+.Indexed.Equiv0Norm as Pi^
import Pi+.Indexed.Equiv1Norm as Pi^
open import Pi+.UFin
open import Pi+.UFin.Monoidal
open import Pi+.Common.FinHelpers
open import Pi+.Lehmer.FinHelpers

module Pi+.Indexed.Examples where

private
  variable
    m n o p q r : ‚Ñï

instance
  ltS : {m : ‚Ñï} ‚Üí m N.< (S m)
  ltS = N.ltS
  ltSR : {m n : ‚Ñï} ‚Üí {{m N.< n}} ‚Üí m N.< (S n)
  ltSR {m} {n} {{œï}} = N.ltSR œï

‚ü¶_‚üß : Pi.U ‚Üí Type‚ÇÄ
‚ü¶ O ‚üß = ‚ä•
‚ü¶ I ‚üß = ‚ä§
‚ü¶ t‚ÇÅ + t‚ÇÇ ‚üß = ‚ü¶ t‚ÇÅ ‚üß ‚äî ‚ü¶ t‚ÇÇ ‚üß
‚ü¶ t‚ÇÅ √ó t‚ÇÇ ‚üß = ‚ü¶ t‚ÇÅ ‚üß S.√ó ‚ü¶ t‚ÇÇ ‚üß

‚ü¶-‚üß-eval‚ÇÄ : {X : Pi.U} ‚Üí ‚ü¶ X ‚üß ‚âÉ Fin (eval‚ÇÄ X)
‚ü¶-‚üß-eval‚ÇÄ {O} =
  Fin-equiv-Empty ‚Åª¬π
‚ü¶-‚üß-eval‚ÇÄ {I} =
  contr-equiv-Unit Fin1-level ‚Åª¬π
‚ü¶-‚üß-eval‚ÇÄ {t‚ÇÅ + t‚ÇÇ} =
  Fin-‚äî {eval‚ÇÄ t‚ÇÅ} {eval‚ÇÄ t‚ÇÇ} ‚àòe
  ‚äî-‚âÉ (‚ü¶-‚üß-eval‚ÇÄ {t‚ÇÅ}) (‚ü¶-‚üß-eval‚ÇÄ {t‚ÇÇ})
‚ü¶-‚üß-eval‚ÇÄ {t‚ÇÅ √ó t‚ÇÇ} =
  Fin-√ó {eval‚ÇÄ t‚ÇÅ} {eval‚ÇÄ t‚ÇÇ} ‚àòe
  √ó-‚âÉ (‚ü¶-‚üß-eval‚ÇÄ {t‚ÇÅ}) (‚ü¶-‚üß-eval‚ÇÄ {t‚ÇÇ})

ùüö : Pi.U
ùüö = I + I

ùüú+ : Pi+.U 4
ùüú+ = I + I + I + I + O

ùü†+ : Pi+.U 8
ùü†+ = I + I + I + I + I + I + I + I + O

ùîπ : ‚Ñï ‚Üí Pi.U
ùîπ O = I
ùîπ (S O) = ùüö
ùîπ (S (S n)) = ùüö √ó ùîπ (S n)

test0 : ‚ü¶ ùüö Pi.+ ùüö ‚üß ‚Üí Fin 4
test0 = ‚Äì> ‚ü¶-‚üß-eval‚ÇÄ

_ : (test0 (inr (inr tt)) == 0) S.√ó
    (test0 (inr (inl tt)) == 1) S.√ó
    (test0 (inl (inr tt)) == 2) S.√ó
    (test0 (inl (inl tt)) == 3)
_ = fin= idp , fin= idp , fin= idp , fin= idp

test1 : ‚ü¶ ùîπ 2 ‚üß ‚Üí Fin 4
test1 = ‚Äì> ‚ü¶-‚üß-eval‚ÇÄ

_ : (test1 (inr tt , inr tt) == 0) S.√ó
    (test1 (inr tt , inl tt) == 1) S.√ó
    (test1 (inl tt , inr tt) == 2) S.√ó
    (test1 (inl tt , inl tt) == 3)
_ = fin= idp , fin= idp , fin= idp , fin= idp

interp' : {X : Pi.U} (c : X Pi.‚ü∑‚ÇÅ X) ‚Üí ‚ü¶ X ‚üß ‚âÉ ‚ü¶ X ‚üß
interp' c = ‚ü¶-‚üß-eval‚ÇÄ ‚Åª¬π ‚àòe Pi^.evalNorm‚ÇÅ (eval‚ÇÅ c) ‚àòe ‚ü¶-‚üß-eval‚ÇÄ

swap2 : ùîπ 2 Pi.‚ü∑‚ÇÅ ùîπ 2
swap2 = swap‚ãÜ

_ : (‚Äì> (interp' swap2) (inr tt , inr tt) == inr tt , inr tt) S.√ó
    (‚Äì> (interp' swap2) (inr tt , inl tt) == inl tt , inr tt) S.√ó
    (‚Äì> (interp' swap2) (inl tt , inr tt) == inr tt , inl tt) S.√ó
    (‚Äì> (interp' swap2) (inl tt , inl tt) == inl tt , inl tt)
_ = idp , idp , idp , idp

controlled : {t : Pi.U} ‚Üí (c : t Pi.‚ü∑‚ÇÅ t) ‚Üí (ùüö Pi.√ó t Pi.‚ü∑‚ÇÅ ùüö Pi.√ó t)
controlled c = dist ‚óé ((id‚ü∑‚ÇÅ ‚äó c) ‚äï id‚ü∑‚ÇÅ) ‚óé factor

controlled^ : {t : Pi.U} ‚Üí (c : t Pi.‚ü∑‚ÇÅ t) ‚Üí _
controlled^ c = eval‚ÇÅ (controlled c)

cif : {t : Pi.U} ‚Üí (c‚ÇÅ c‚ÇÇ : t Pi.‚ü∑‚ÇÅ t) ‚Üí (ùüö Pi.√ó t Pi.‚ü∑‚ÇÅ ùüö Pi.√ó t)
cif c‚ÇÅ c‚ÇÇ = dist ‚óé ((id‚ü∑‚ÇÅ ‚äó c‚ÇÅ) ‚äï (id‚ü∑‚ÇÅ ‚äó c‚ÇÇ)) ‚óé factor

cif^ : {t : Pi.U} ‚Üí (c‚ÇÅ c‚ÇÇ : t Pi.‚ü∑‚ÇÅ t) ‚Üí _
cif^ c‚ÇÅ c‚ÇÇ = eval‚ÇÅ (cif c‚ÇÅ c‚ÇÇ)

not : ùüö Pi.‚ü∑‚ÇÅ ùüö
not = swap‚Çä

not^ : 2 Pi^.‚ü∑‚ÇÅ^ 2
not^ = eval‚ÇÅ not

not^p : Fin 2 ‚Üí Fin 2
not^p = ‚Äì> (Pi^.evalNorm‚ÇÅ not^)

_ : (not^p 0 == 1) S.√ó (not^p 1 == 0)
_ = fin= idp , fin= idp

cnot : ùüö Pi.√ó ùüö Pi.‚ü∑‚ÇÅ ùüö Pi.√ó ùüö
cnot = controlled not

cnot^ : 4 ‚ü∑‚ÇÅ^ 4
cnot^ = eval‚ÇÅ cnot

cnot^p : Fin 4 ‚Üí Fin 4
cnot^p = ‚Äì> (Pi^.evalNorm‚ÇÅ cnot^)

_ : (cnot^p 0 == 0) S.√ó (cnot^p 1 == 1) S.√ó (cnot^p 2 == 3) S.√ó (cnot^p 3 == 2)
_ = fin= idp , fin= idp , fin= idp , fin= idp

toffoli‚ÇÉ : ùüö Pi.√ó (ùüö Pi.√ó ùüö) Pi.‚ü∑‚ÇÅ ùüö Pi.√ó (ùüö Pi.√ó ùüö)
toffoli‚ÇÉ = controlled cnot

toffoli‚ÇÉ^ : 8 ‚ü∑‚ÇÅ^ 8
toffoli‚ÇÉ^ = eval‚ÇÅ toffoli‚ÇÉ

toffoli : ‚àÄ n ‚Üí ùîπ n Pi.‚ü∑‚ÇÅ ùîπ n
toffoli O = id‚ü∑‚ÇÅ
toffoli (S O) = swap‚Çä
toffoli (S (S n)) = cif (toffoli (S n)) id‚ü∑‚ÇÅ

toffoli^ : ‚àÄ n ‚Üí _
toffoli^ = eval‚ÇÅ ‚àò toffoli

toffoli+ : ‚àÄ n ‚Üí _
toffoli+ = Pi^.quote^‚ÇÅ ‚àò Pi^.quoteNorm‚ÇÅ idp ‚àò Pi^.evalNorm‚ÇÅ ‚àò toffoli^

{--
toffoli 3:
----------

dist ‚óé
((id‚ü∑‚ÇÅ ‚äó (dist ‚óé ((id‚ü∑‚ÇÅ ‚äó swap‚Çä) ‚äï (id‚ü∑‚ÇÅ ‚äó id‚ü∑‚ÇÅ)) ‚óé factor)) ‚äï
 (id‚ü∑‚ÇÅ ‚äó id‚ü∑‚ÇÅ))
‚óé factor

toffoli+ 3:
-----------

(assocl‚Çä ‚óé (swap‚Çä ‚äï id‚ü∑‚ÇÅ) ‚óé assocr‚Çä) ‚óé id‚ü∑‚ÇÅ

swap78:
-------



--}

swap67 : Aut (Fin 8)
swap67 = equiv f f f-f f-f
  where f : Fin 8 ‚Üí Fin 8
        f (O , œï) = 0
        f (1 , œï) = 1
        f (2 , œï) = 2
        f (3 , œï) = 3
        f (4 , œï) = 4
        f (5 , œï) = 5
        f (6 , œï) = 7
        f (7 , œï) = 6
        f (n , N.ltSR (N.ltSR (N.ltSR (N.ltSR (N.ltSR (N.ltSR (N.ltSR (N.ltSR ()))))))))
        f-f : (x : Fin 8) ‚Üí f (f x) == x
        f-f (O , œï) = fin= idp
        f-f (1 , œï) = fin= idp
        f-f (2 , œï) = fin= idp
        f-f (3 , œï) = fin= idp
        f-f (4 , œï) = fin= idp
        f-f (5 , œï) = fin= idp
        f-f (6 , œï) = fin= idp
        f-f (7 , œï) = fin= idp
        f-f (n , N.ltSR (N.ltSR (N.ltSR (N.ltSR (N.ltSR (N.ltSR (N.ltSR (N.ltSR ()))))))))

swap67^ : 8 Pi^.‚ü∑‚ÇÅ^ 8
swap67^ = Pi^.quoteNorm‚ÇÅ idp swap67

toffoli3+ : ùü†+ Pi+.‚ü∑‚ÇÅ ùü†+
toffoli3+ = Pi^.quote^‚ÇÅ swap67^

toffoli^2-perm : Aut (Fin 4)
toffoli^2-perm = Pi^.evalNorm‚ÇÅ (toffoli^ 2)

swap23 : Aut (Fin 4)
swap23 = equiv f f f-f f-f
  where f : Fin 4 ‚Üí Fin 4
        f (O , œï) = 0
        f (1 , œï) = 1
        f (2 , œï) = 3
        f (3 , œï) = 2
        f (n , N.ltSR (N.ltSR (N.ltSR (N.ltSR ()))))
        f-f : (x : Fin 4) ‚Üí f (f x) == x
        f-f (O , œï) = fin= idp
        f-f (1 , œï) = fin= idp
        f-f (2 , œï) = fin= idp
        f-f (3 , œï) = fin= idp
        f-f (n , N.ltSR (N.ltSR (N.ltSR (N.ltSR ()))))

toffoli^2perm=swap23 : toffoli^2-perm == swap23
toffoli^2perm=swap23 = e= œï
  where œï : (f : Fin 4) ‚Üí ‚Äì> toffoli^2-perm f == ‚Äì> swap23 f
        œï (O , œï) = fin= idp
        œï (1 , œï) = fin= idp
        œï (2 , œï) = fin= idp
        œï (3 , œï) = fin= idp
        œï (n , N.ltSR (N.ltSR (N.ltSR (N.ltSR ()))))

swap23^ : 4 Pi^.‚ü∑‚ÇÅ^ 4
swap23^ = Pi^.quoteNorm‚ÇÅ idp swap23

toffoli^2=swap23^ : toffoli^ 2 Pi^.‚ü∑‚ÇÇ^ swap23^
toffoli^2=swap23^ = (((c‚ÇÇ ‚ä°^ c‚ÇÇ) ‚ä°^ ((c‚ÇÉ ‚ä°^ (c‚ÇÑ ‚ä°^ (c‚ÇÇ ‚ä°^ c‚ÇÇ))) ‚ä°^ (c‚ÇÇ ‚ä°^ c‚ÇÇ))) ‚ñ†^
                    (idl‚óél^ ‚ä°^ (idl‚óél^ ‚ä°^ idl‚óél^)) ‚ñ†^
                    idl‚óél^ ‚ñ†^ idr‚óél^ ‚ñ†^ assoc‚óél^ ‚ñ†^ idr‚óél^ ‚ñ†^ idr‚óél^) ‚ñ†^ idr‚óér^
  where c‚ÇÇ : ‚äï^ ‚äï^ id‚ü∑‚ÇÅ^ ‚ü∑‚ÇÇ^ id‚ü∑‚ÇÅ^
        c‚ÇÇ = (resp‚äï‚ü∑‚ÇÇ ‚äïid‚ü∑‚ÇÅ‚ü∑‚ÇÇ^) ‚ñ†^ ‚äïid‚ü∑‚ÇÅ‚ü∑‚ÇÇ^
        c‚ÇÉ : (‚äï^ ‚äï^ ‚äï^ ‚äï^ id‚ü∑‚ÇÅ^) ‚ü∑‚ÇÇ^ id‚ü∑‚ÇÅ^
        c‚ÇÉ = resp‚äï‚ü∑‚ÇÇ (resp‚äï‚ü∑‚ÇÇ (resp‚äï‚ü∑‚ÇÇ ‚äïid‚ü∑‚ÇÅ‚ü∑‚ÇÇ^)) ‚ñ†^
             resp‚äï‚ü∑‚ÇÇ (resp‚äï‚ü∑‚ÇÇ ‚äïid‚ü∑‚ÇÅ‚ü∑‚ÇÇ^) ‚ñ†^
             resp‚äï‚ü∑‚ÇÇ ‚äïid‚ü∑‚ÇÅ‚ü∑‚ÇÇ^ ‚ñ†^
             ‚äïid‚ü∑‚ÇÅ‚ü∑‚ÇÇ^
        c‚ÇÑ : (swap‚Çä^ ‚óé^ ‚äï^ ‚äï^ id‚ü∑‚ÇÅ^) ‚ü∑‚ÇÇ^ swap‚Çä^
        c‚ÇÑ = (id‚ü∑‚ÇÇ^ ‚ä°^ c‚ÇÇ) ‚ñ†^ idr‚óél^

swap23+ : ùüú+ Pi+.‚ü∑‚ÇÅ ùüú+
swap23+ = Pi+.quote‚ÇÅ idp swap23

toffoli2+ : ùüú+ Pi+.‚ü∑‚ÇÅ ùüú+
toffoli2+ = Pi^.quote^‚ÇÅ swap23^

-- copy(ùîΩ,b‚ÇÅ,‚Ä¶,b‚Çô) = (b‚ÇÅ,b‚ÇÅ,‚Ä¶,b‚Çô)
copy : ‚àÄ n ‚Üí ùüö Pi.√ó ùîπ n Pi.‚ü∑‚ÇÅ ùüö Pi.√ó ùîπ n
copy O = id‚ü∑‚ÇÅ
copy (S O) = swap‚ãÜ ‚óé cnot ‚óé swap‚ãÜ
copy (S (S n)) = assocl‚ãÜ ‚óé (copy (S O) ‚äó id‚ü∑‚ÇÅ) ‚óé assocr‚ãÜ

copy^ : ‚àÄ n ‚Üí _
copy^ = eval‚ÇÅ ‚àò copy

copy+ : ‚àÄ n ‚Üí _
copy+ = Pi^.quote^‚ÇÅ ‚àò Pi^.quoteNorm‚ÇÅ idp ‚àò Pi^.evalNorm‚ÇÅ ‚àò copy^

rearrange : (t‚ÇÅ t‚ÇÇ t‚ÇÉ : Pi.U) ‚Üí t‚ÇÅ Pi.√ó (t‚ÇÇ Pi.√ó t‚ÇÉ) Pi.‚ü∑‚ÇÅ t‚ÇÇ Pi.√ó (t‚ÇÅ Pi.√ó t‚ÇÉ)
rearrange t‚ÇÅ t‚ÇÇ t‚ÇÉ = assocl‚ãÜ ‚óé (swap‚ãÜ ‚äó id‚ü∑‚ÇÅ) ‚óé assocr‚ãÜ

reset : ‚àÄ n ‚Üí ùüö Pi.√ó ùîπ n Pi.‚ü∑‚ÇÅ ùüö Pi.√ó ùîπ n
reset O = id‚ü∑‚ÇÅ
reset (S O) = swap‚ãÜ ‚óé cnot ‚óé swap‚ãÜ
reset (S (S n)) = rearrange ùüö ùüö (ùîπ (S n)) ‚óé cif (not ‚äó id‚ü∑‚ÇÅ) (reset (S n)) ‚óé rearrange ùüö ùüö (ùîπ (S n))

{--

Write another circuit that does this addition:

0 -> 0
8 -> 8
n -> n + 8 `mod` 16

use algorithm in \cite{10.1145/775832.775915}

when we normalize we should get the same as reset+
        f1    f2      f3      f4         f5     f6         f7          f8
            cx(3,0) cx(2,0) ccx(2,3,0) cx(1,0) ccx(1,3,0) ccx(1,2,0) cccx(1,2,3,0)
0000 - 0000  0000    0000    0000       0000   0000       0000        0000
0001 - 1001  0001    0001    0001       0001   0001       0001        0001
0010 - 1010  1010    0010    0010       0010   0010       0010        0010
0011 - 1011  0011    1011    0011       0011   0011       0011        0011
0100 - 1100  1100    1100    1100       0100   0100       0100        0100
0101 - 1101  0101    0101    0101       1101   0101       0101        0101
0110 - 1110  1110    0110    0110       1110   1110       0110        0110
0111 - 1111  0111    1111    0111       1111   0111       1111        0111
1000 - 1000  1000    1000    1000       1000   1000       1000        1000
1001 - 0001  1001    1001    1001       1001   1001       1001        1001
1010 - 0010  0010    1010    1010       1010   1010       1010        1010
1011 - 0011  1011    0011    1011       1011   1011       1011        1011
1100 - 0100  0100    0100    0100       1100   1100       1100        1100
1101 - 0101  1101    1101    1101       0101   1101       1101        1101
1110 - 0110  0110    1110    1110       0110   0110       1110        1110
1111 - 0111  1111    0111    1111       0111   1111       0111        1111

circuit:

  cccx(1,2,3,0);
  ccx(1,2,0);
  ccx(1,3,0);
  cx(1,0);
  ccx(2,3,0);
  cx(2,0);
  cx(3,0)

check

0000
0001
0010 1010
0011 1011 0011 1011
0100 1100
0101 1101 0101 1101
0110 1110 0110 1110
0111 1111 0111 1111 0111 1111 0111 1111
1000
1001 0001
1010 0010
1011 0011 1011 0011
1100 0100
1101 0101 1101 0101
1110 0110 1110 0110
1111 0111 1111 0111 1111 0111 1111 0111

adder : ùîπ 4 Pi.‚ü∑‚ÇÅ ùîπ 4
adder = -- 0 x (1 x (2 x 3))
  swap‚ãÜ ‚óé -- (1 x (2 x 3)) x 0
  assocr‚ãÜ ‚óé -- 1 x ((2 x 3) x 0)
  (id‚ü∑‚ÇÅ ‚äó assocr‚ãÜ) ‚óé -- 1 x (2 x (3 x 0))
  toffoli 4 ‚óé -- 1 x (2 x (3 x 0))
  (id‚ü∑‚ÇÅ ‚äó (id‚ü∑‚ÇÅ ‚äó swap‚ãÜ)) ‚óé -- 1 x (2 x (0 x 3)
  (id‚ü∑‚ÇÅ ‚äó assocl‚ãÜ) ‚óé -- 1 x ((2 x 0) x 3)
  assocl‚ãÜ ‚óé -- (1 x (2 x 0)) x 3
  (toffoli 3 ‚äó id‚ü∑‚ÇÅ) ‚óé -- (1 x (2 x 0)) x 3
  assocr‚ãÜ ‚óé -- 1 x ((2 x 0) x 3)
  (id‚ü∑‚ÇÅ ‚äó swap‚ãÜ) ‚óé -- 1 x (3 x (2 x 0))
  (id‚ü∑‚ÇÅ ‚äó (id‚ü∑‚ÇÅ ‚äó swap‚ãÜ)) ‚óé -- 1 x (3 x (0 x 2))
  (id‚ü∑‚ÇÅ ‚äó assocl‚ãÜ) ‚óé -- 1 x ((3 x 0) x 2)
  assocl‚ãÜ ‚óé -- (1 x (3 x 0)) x 2
  (toffoli 3 ‚äó id‚ü∑‚ÇÅ) ‚óé -- (1 x (3 x 0)) x 2
  ((id‚ü∑‚ÇÅ ‚äó swap‚ãÜ) ‚äó id‚ü∑‚ÇÅ) ‚óé -- (1 x (0 x 3)) x 2
  (assocl‚ãÜ ‚äó id‚ü∑‚ÇÅ) ‚óé -- ((1 x 0) x 3) x 2
  ((cnot ‚äó id‚ü∑‚ÇÅ) ‚äó id‚ü∑‚ÇÅ) ‚óé -- ((1 x 0) x 3) x 2
  assocr‚ãÜ ‚óé -- (1 x 0) x (3 x 2)
  (swap‚ãÜ ‚äó id‚ü∑‚ÇÅ) ‚óé -- (0 x 1) x (3 x 2)
  swap‚ãÜ ‚óé -- (3 x 2) x (0 x 1)
  assocl‚ãÜ ‚óé -- ((3 x 2) x 0) x 1
  (assocr‚ãÜ ‚äó id‚ü∑‚ÇÅ) ‚óé -- (3 x (2 x 0)) x 1
  (toffoli 3 ‚äó id‚ü∑‚ÇÅ) ‚óé -- (3 x (2 x 0)) x 1
  ((id‚ü∑‚ÇÅ ‚äó cnot) ‚äó id‚ü∑‚ÇÅ) ‚óé -- (3 x (2 x 0)) x 1
  ((id‚ü∑‚ÇÅ ‚äó swap‚ãÜ) ‚äó id‚ü∑‚ÇÅ) ‚óé -- (3 x (0 x 2)) x 1
  (assocl‚ãÜ ‚äó id‚ü∑‚ÇÅ) ‚óé -- ((3 x 0) x 2) x 1
  ((cnot ‚äó id‚ü∑‚ÇÅ) ‚äó id‚ü∑‚ÇÅ) ‚óé -- ((3 x 0) x 2) x 1
  ((swap‚ãÜ ‚äó id‚ü∑‚ÇÅ) ‚äó id‚ü∑‚ÇÅ) ‚óé -- ((0 x 3) x 2) x 1
  (assocr‚ãÜ ‚äó id‚ü∑‚ÇÅ) ‚óé -- (0 x (3 x 2)) x 1
  assocr‚ãÜ ‚óé -- 0 x ((3 x 2) x 1)
  (id‚ü∑‚ÇÅ ‚äó swap‚ãÜ) ‚óé -- 0 x (1 x (3 x 2))
  (id‚ü∑‚ÇÅ ‚äó (id‚ü∑‚ÇÅ ‚äó swap‚ãÜ)) -- 0 x (1 x (2 x 3))

--}

reset^ : ‚àÄ n ‚Üí _
reset^ = eval‚ÇÅ ‚àò reset

reset+ : ‚àÄ n ‚Üí _
reset+ = Pi^.quote^‚ÇÅ ‚àò Pi^.quoteNorm‚ÇÅ idp ‚àò Pi^.evalNorm‚ÇÅ ‚àò reset^

{--
reset 2:
-------

(assocl‚ãÜ ‚óé (swap‚ãÜ ‚äó id‚ü∑‚ÇÅ) ‚óé assocr‚ãÜ) ‚óé
(dist ‚óé
 ((id‚ü∑‚ÇÅ ‚äó (swap‚Çä ‚äó id‚ü∑‚ÇÅ)) ‚äï
  (id‚ü∑‚ÇÅ ‚äó
   (swap‚ãÜ ‚óé (dist ‚óé ((id‚ü∑‚ÇÅ ‚äó swap‚Çä) ‚äï id‚ü∑‚ÇÅ) ‚óé factor) ‚óé swap‚ãÜ)))
 ‚óé factor)
‚óé assocl‚ãÜ ‚óé (swap‚ãÜ ‚äó id‚ü∑‚ÇÅ) ‚óé assocr‚ãÜ

reset+ 2:
---------

(id‚ü∑‚ÇÅ ‚äï id‚ü∑‚ÇÅ ‚äï id‚ü∑‚ÇÅ ‚äï id‚ü∑‚ÇÅ ‚äï assocl‚Çä ‚óé (swap‚Çä ‚äï id‚ü∑‚ÇÅ) ‚óé assocr‚Çä) ‚óé
(id‚ü∑‚ÇÅ ‚äï
 id‚ü∑‚ÇÅ ‚äï id‚ü∑‚ÇÅ ‚äï id‚ü∑‚ÇÅ ‚äï id‚ü∑‚ÇÅ ‚äï assocl‚Çä ‚óé (swap‚Çä ‚äï id‚ü∑‚ÇÅ) ‚óé assocr‚Çä)
‚óé
(id‚ü∑‚ÇÅ ‚äï id‚ü∑‚ÇÅ ‚äï id‚ü∑‚ÇÅ ‚äï id‚ü∑‚ÇÅ ‚äï assocl‚Çä ‚óé (swap‚Çä ‚äï id‚ü∑‚ÇÅ) ‚óé assocr‚Çä) ‚óé
id‚ü∑‚ÇÅ

adder:
------

swap‚ãÜ ‚óé
(swap‚ãÜ ‚äó id‚ü∑‚ÇÅ) ‚óé
assocr‚ãÜ ‚óé
(dist ‚óé
 ((id‚ü∑‚ÇÅ ‚äó (dist ‚óé ((id‚ü∑‚ÇÅ ‚äó swap‚Çä) ‚äï (id‚ü∑‚ÇÅ ‚äó id‚ü∑‚ÇÅ)) ‚óé factor)) ‚äï
  (id‚ü∑‚ÇÅ ‚äó id‚ü∑‚ÇÅ))
 ‚óé factor)
‚óé
(id‚ü∑‚ÇÅ ‚äó (dist ‚óé ((id‚ü∑‚ÇÅ ‚äó swap‚Çä) ‚äï id‚ü∑‚ÇÅ) ‚óé factor)) ‚óé
assocl‚ãÜ ‚óé
(swap‚ãÜ ‚äó id‚ü∑‚ÇÅ) ‚óé
assocr‚ãÜ ‚óé
(id‚ü∑‚ÇÅ ‚äó (dist ‚óé ((id‚ü∑‚ÇÅ ‚äó swap‚Çä) ‚äï id‚ü∑‚ÇÅ) ‚óé factor)) ‚óé
assocl‚ãÜ ‚óé swap‚ãÜ

adder+:
-------



--}

{--

0 -> 0
4 -> 4
n -> n + 4 `mod` 8

    f1     f2      f3       f4
         cx(2,0)  cx(1,0)  ccx(1,2,0)
000 000  000      000      000
001 101  001      001      001
010 110  110      010      010
011 111  011      111      011
100 100  100      100      100
101 001  101      101      101
110 010  010      110      110
111 011  111      011      111

circuit
ccx(1,2,0); cx(1,0); cx(2,0)

--}

adder : ùîπ 3 Pi.‚ü∑‚ÇÅ ùîπ 3
adder = -- 0 * (1 * 2)
  swap‚ãÜ ‚óé -- (1 * 2) * 0
  (swap‚ãÜ ‚äó id‚ü∑‚ÇÅ) ‚óé -- (2 * 1) * 0
  assocr‚ãÜ ‚óé -- 2 * (1 * 0)
  toffoli 3 ‚óé -- 2 * (1 * 0)
  (id‚ü∑‚ÇÅ ‚äó cnot) ‚óé -- 2 * (1 * 0)
  assocl‚ãÜ ‚óé -- (2 * 1) * 0
  (swap‚ãÜ ‚äó id‚ü∑‚ÇÅ) ‚óé -- (1 * 2) * 0
  assocr‚ãÜ ‚óé -- 1 * (2 * 0)
  (id‚ü∑‚ÇÅ ‚äó cnot) ‚óé -- 1 * (2 * 0)
  assocl‚ãÜ ‚óé -- (1 * 2) * 0
  swap‚ãÜ -- 0 * (1 * 2)

--adder+ : Pi^.quote^‚ÇÄ 8 Pi+.‚ü∑‚ÇÅ Pi^.quote^‚ÇÄ 8
--adder+ = (Pi^.quote^‚ÇÅ ‚àò Pi^.quoteNorm‚ÇÅ idp ‚àò Pi^.evalNorm‚ÇÅ ‚àò eval‚ÇÅ) adder

-- x = eval‚ÇÅ adder
x = _‚óé^_ {8} {8} {8}
 (_‚óé^_ {8} {8} {8}
 (‚äï^_ {7} {7}
  (‚äï^_ {6} {6}
   (‚äï^_ {5} {5}
    (‚äï^_ {4} {4}
     (_‚óé^_ {4} {4} {4}
      (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
      (_‚óé^_ {4} {4} {4}
       (_‚óé^_ {4} {4} {4}
        (‚äï^_ {3} {3}
         (_‚óé^_ {3} {3} {3}
          (‚äï^_ {2} {2}
           (_‚óé^_ {2} {2} {2}
            (‚äï^_ {1} {1}
             (_‚óé^_ {1} {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))
              (_‚óé^_ {1} {1} {1} (id‚ü∑‚ÇÅ^ {1})
               (_‚óé^_ {1} {1} {1} (id‚ü∑‚ÇÅ^ {1}) (id‚ü∑‚ÇÅ^ {1})))))
            (_‚óé^_ {2} {2} {2}
             (_‚óé^_ {2} {2} {2} (swap‚Çä^ {0}) (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))
             (_‚óé^_ {2} {2} {2} (id‚ü∑‚ÇÅ^ {2})
              (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})) (swap‚Çä^ {0}))))))
          (_‚óé^_ {3} {3} {3}
           (_‚óé^_ {3} {3} {3} (swap‚Çä^ {1})
            (‚äï^_ {2} {2}
             (_‚óé^_ {2} {2} {2} (swap‚Çä^ {0}) (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))
           (_‚óé^_ {3} {3} {3} (id‚ü∑‚ÇÅ^ {3})
            (_‚óé^_ {3} {3} {3}
             (‚äï^_ {2} {2}
              (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})) (swap‚Çä^ {0})))
             (swap‚Çä^ {1}))))))
        (_‚óé^_ {4} {4} {4}
         (_‚óé^_ {4} {4} {4} (swap‚Çä^ {2})
          (‚äï^_ {3} {3}
           (_‚óé^_ {3} {3} {3} (swap‚Çä^ {1})
            (‚äï^_ {2} {2}
             (_‚óé^_ {2} {2} {2} (swap‚Çä^ {0}) (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))))
         (_‚óé^_ {4} {4} {4} (id‚ü∑‚ÇÅ^ {4})
          (_‚óé^_ {4} {4} {4}
           (‚äï^_ {3} {3}
            (_‚óé^_ {3} {3} {3}
             (‚äï^_ {2} {2}
              (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})) (swap‚Çä^ {0})))
             (swap‚Çä^ {1})))
           (swap‚Çä^ {2})))))
       (_‚óé^_ {4} {4} {4}
        (_‚óé^_ {4} {4} {4}
         (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
         (_‚óé^_ {4} {4} {4}
          (_‚óé^_ {4} {4} {4}
           (_‚óé^_ {4} {4} {4}
            (_‚óé^_ {4} {4} {4} (_‚óé^_ {4} {4} {4} (id‚ü∑‚ÇÅ^ {4}) (id‚ü∑‚ÇÅ^ {4}))
             (_‚óé^_ {4} {4} {4}
              (_‚óé^_ {4} {4} {4} (_‚óé^_ {4} {4} {4} (id‚ü∑‚ÇÅ^ {4}) (id‚ü∑‚ÇÅ^ {4}))
               (id‚ü∑‚ÇÅ^ {4}))
              (‚äï^_ {3} {3} (id‚ü∑‚ÇÅ^ {3}))))
            (‚äï^_ {3} {3} (id‚ü∑‚ÇÅ^ {3})))
           (id‚ü∑‚ÇÅ^ {4}))
          (‚äï^_ {3} {3}
           (_‚óé^_ {3} {3} {3}
            (_‚óé^_ {3} {3} {3}
             (_‚óé^_ {3} {3} {3}
              (_‚óé^_ {3} {3} {3} (_‚óé^_ {3} {3} {3} (id‚ü∑‚ÇÅ^ {3}) (id‚ü∑‚ÇÅ^ {3}))
               (_‚óé^_ {3} {3} {3}
                (_‚óé^_ {3} {3} {3} (_‚óé^_ {3} {3} {3} (id‚ü∑‚ÇÅ^ {3}) (id‚ü∑‚ÇÅ^ {3}))
                 (id‚ü∑‚ÇÅ^ {3}))
                (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2}))))
              (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
             (id‚ü∑‚ÇÅ^ {3}))
            (‚äï^_ {2} {2}
             (_‚óé^_ {2} {2} {2}
              (_‚óé^_ {2} {2} {2}
               (_‚óé^_ {2} {2} {2}
                (_‚óé^_ {2} {2} {2} (_‚óé^_ {2} {2} {2} (id‚ü∑‚ÇÅ^ {2}) (id‚ü∑‚ÇÅ^ {2}))
                 (_‚óé^_ {2} {2} {2}
                  (_‚óé^_ {2} {2} {2} (_‚óé^_ {2} {2} {2} (id‚ü∑‚ÇÅ^ {2}) (id‚ü∑‚ÇÅ^ {2}))
                   (id‚ü∑‚ÇÅ^ {2}))
                  (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1}))))
                (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))
               (id‚ü∑‚ÇÅ^ {2}))
              (‚äï^_ {1} {1}
               (_‚óé^_ {1} {1} {1}
                (_‚óé^_ {1} {1} {1}
                 (_‚óé^_ {1} {1} {1}
                  (_‚óé^_ {1} {1} {1} (_‚óé^_ {1} {1} {1} (id‚ü∑‚ÇÅ^ {1}) (id‚ü∑‚ÇÅ^ {1}))
                   (_‚óé^_ {1} {1} {1}
                    (_‚óé^_ {1} {1} {1} (_‚óé^_ {1} {1} {1} (id‚ü∑‚ÇÅ^ {1}) (id‚ü∑‚ÇÅ^ {1}))
                     (id‚ü∑‚ÇÅ^ {1}))
                    (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
                  (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
                 (id‚ü∑‚ÇÅ^ {1}))
                (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))
        (‚äï^_ {3} {3}
         (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))))
 (_‚óé^_ {8} {8} {8}
  (_‚óé^_ {8} {8} {8}
   (‚äï^_ {7} {7}
    (_‚óé^_ {7} {7} {7}
     (‚äï^_ {6} {6}
      (_‚óé^_ {6} {6} {6}
       (‚äï^_ {5} {5}
        (_‚óé^_ {5} {5} {5}
         (‚äï^_ {4} {4}
          (‚äï^_ {3} {3}
           (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
         (_‚óé^_ {5} {5} {5}
          (_‚óé^_ {5} {5} {5} (swap‚Çä^ {3})
           (‚äï^_ {4} {4}
            (_‚óé^_ {4} {4} {4} (swap‚Çä^ {2})
             (‚äï^_ {3} {3}
              (_‚óé^_ {3} {3} {3} (swap‚Çä^ {1})
               (‚äï^_ {2} {2}
                (_‚óé^_ {2} {2} {2} (swap‚Çä^ {0}) (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))))))
          (_‚óé^_ {5} {5} {5}
           (‚äï^_ {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))
           (‚äï^_ {4} {4}
            (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))))))
       (_‚óé^_ {6} {6} {6}
        (_‚óé^_ {6} {6} {6} (swap‚Çä^ {4})
         (‚äï^_ {5} {5}
          (_‚óé^_ {5} {5} {5} (swap‚Çä^ {3})
           (‚äï^_ {4} {4}
            (_‚óé^_ {4} {4} {4} (swap‚Çä^ {2})
             (‚äï^_ {3} {3}
              (_‚óé^_ {3} {3} {3} (swap‚Çä^ {1})
               (‚äï^_ {2} {2}
                (_‚óé^_ {2} {2} {2} (swap‚Çä^ {0}) (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))))))))
        (_‚óé^_ {6} {6} {6}
         (‚äï^_ {5} {5} (‚äï^_ {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))))
         (‚äï^_ {5} {5}
          (‚äï^_ {4} {4}
           (‚äï^_ {3} {3}
            (‚äï^_ {2} {2}
             (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})) (swap‚Çä^ {0}))))))))))
     (_‚óé^_ {7} {7} {7}
      (_‚óé^_ {7} {7} {7} (swap‚Çä^ {5})
       (‚äï^_ {6} {6}
        (_‚óé^_ {6} {6} {6} (swap‚Çä^ {4})
         (‚äï^_ {5} {5}
          (_‚óé^_ {5} {5} {5} (swap‚Çä^ {3})
           (‚äï^_ {4} {4}
            (_‚óé^_ {4} {4} {4} (swap‚Çä^ {2})
             (‚äï^_ {3} {3}
              (_‚óé^_ {3} {3} {3} (swap‚Çä^ {1})
               (‚äï^_ {2} {2}
                (_‚óé^_ {2} {2} {2} (swap‚Çä^ {0}) (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))))))))))
      (_‚óé^_ {7} {7} {7}
       (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (‚äï^_ {3} {3} (id‚ü∑‚ÇÅ^ {3})))))
       (‚äï^_ {6} {6}
        (‚äï^_ {5} {5}
         (‚äï^_ {4} {4}
          (‚äï^_ {3} {3}
           (_‚óé^_ {3} {3} {3}
            (‚äï^_ {2} {2}
             (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})) (swap‚Çä^ {0})))
            (swap‚Çä^ {1}))))))))))
   (_‚óé^_ {8} {8} {8}
    (_‚óé^_ {8} {8} {8} (swap‚Çä^ {6})
     (‚äï^_ {7} {7}
      (_‚óé^_ {7} {7} {7} (swap‚Çä^ {5})
       (‚äï^_ {6} {6}
        (_‚óé^_ {6} {6} {6} (swap‚Çä^ {4})
         (‚äï^_ {5} {5}
          (_‚óé^_ {5} {5} {5} (swap‚Çä^ {3})
           (‚äï^_ {4} {4}
            (_‚óé^_ {4} {4} {4} (swap‚Çä^ {2})
             (‚äï^_ {3} {3}
              (_‚óé^_ {3} {3} {3} (swap‚Çä^ {1})
               (‚äï^_ {2} {2}
                (_‚óé^_ {2} {2} {2} (swap‚Çä^ {0})
                 (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))))))))))))
    (_‚óé^_ {8} {8} {8}
     (‚äï^_ {7} {7} (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))
     (‚äï^_ {7} {7}
      (‚äï^_ {6} {6}
       (‚äï^_ {5} {5}
        (‚äï^_ {4} {4}
         (_‚óé^_ {4} {4} {4}
          (‚äï^_ {3} {3}
           (_‚óé^_ {3} {3} {3}
            (‚äï^_ {2} {2}
             (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})) (swap‚Çä^ {0})))
            (swap‚Çä^ {1})))
          (swap‚Çä^ {2})))))))))
  (_‚óé^_ {8} {8} {8}
   (_‚óé^_ {8} {8} {8}
    (‚äï^_ {7} {7}
     (‚äï^_ {6} {6}
      (‚äï^_ {5} {5}
       (‚äï^_ {4} {4}
        (‚äï^_ {3} {3}
         (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))
    (_‚óé^_ {8} {8} {8}
     (_‚óé^_ {8} {8} {8}
      (_‚óé^_ {8} {8} {8}
       (_‚óé^_ {8} {8} {8}
        (_‚óé^_ {8} {8} {8} (‚äï^_ {7} {7} (id‚ü∑‚ÇÅ^ {7}))
         (‚äï^_ {7} {7}
          (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))
        (‚äï^_ {7} {7}
         (_‚óé^_ {7} {7} {7}
          (_‚óé^_ {7} {7} {7}
           (_‚óé^_ {7} {7} {7}
            (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))
            (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))
           (_‚óé^_ {7} {7} {7}
            (‚äï^_ {6} {6}
             (_‚óé^_ {6} {6} {6}
              (‚äï^_ {5} {5}
               (_‚óé^_ {5} {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})) (swap‚Çä^ {3})))
              (swap‚Çä^ {4})))
            (swap‚Çä^ {5})))
          (‚äï^_ {6} {6}
           (‚äï^_ {5} {5} (‚äï^_ {4} {4} (‚äï^_ {3} {3} (id‚ü∑‚ÇÅ^ {3}))))))))
       (‚äï^_ {7} {7} (‚äï^_ {6} {6} (id‚ü∑‚ÇÅ^ {6}))))
      (‚äï^_ {7} {7} (id‚ü∑‚ÇÅ^ {7})))
     (‚äï^_ {7} {7}
      (‚äï^_ {6} {6}
       (_‚óé^_ {6} {6} {6}
        (_‚óé^_ {6} {6} {6}
         (_‚óé^_ {6} {6} {6}
          (_‚óé^_ {6} {6} {6}
           (_‚óé^_ {6} {6} {6} (‚äï^_ {5} {5} (id‚ü∑‚ÇÅ^ {5}))
            (‚äï^_ {5} {5} (‚äï^_ {4} {4} (‚äï^_ {3} {3} (id‚ü∑‚ÇÅ^ {3})))))
           (‚äï^_ {5} {5}
            (_‚óé^_ {5} {5} {5}
             (_‚óé^_ {5} {5} {5}
              (_‚óé^_ {5} {5} {5} (‚äï^_ {4} {4} (‚äï^_ {3} {3} (id‚ü∑‚ÇÅ^ {3})))
               (‚äï^_ {4} {4} (‚äï^_ {3} {3} (id‚ü∑‚ÇÅ^ {3}))))
              (_‚óé^_ {5} {5} {5}
               (‚äï^_ {4} {4}
                (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (id‚ü∑‚ÇÅ^ {3})) (swap‚Çä^ {2})))
               (swap‚Çä^ {3})))
             (‚äï^_ {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))))))
          (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))
         (‚äï^_ {5} {5} (id‚ü∑‚ÇÅ^ {5})))
        (‚äï^_ {5} {5}
         (‚äï^_ {4} {4}
          (_‚óé^_ {4} {4} {4}
           (_‚óé^_ {4} {4} {4}
            (_‚óé^_ {4} {4} {4}
             (_‚óé^_ {4} {4} {4}
              (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (id‚ü∑‚ÇÅ^ {3}))
               (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2}))))
              (‚äï^_ {3} {3}
               (_‚óé^_ {3} {3} {3}
                (_‚óé^_ {3} {3} {3}
                 (_‚óé^_ {3} {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2}))
                  (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
                 (_‚óé^_ {3} {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})) (swap‚Çä^ {1})))
                (‚äï^_ {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1}))))))
             (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2}))))
            (‚äï^_ {3} {3} (id‚ü∑‚ÇÅ^ {3})))
           (‚äï^_ {3} {3}
            (‚äï^_ {2} {2}
             (_‚óé^_ {2} {2} {2}
              (_‚óé^_ {2} {2} {2}
               (_‚óé^_ {2} {2} {2}
                (_‚óé^_ {2} {2} {2}
                 (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1}))
                  (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))
                 (‚äï^_ {1} {1}
                  (_‚óé^_ {1} {1} {1}
                   (_‚óé^_ {1} {1} {1} (_‚óé^_ {1} {1} {1} (id‚ü∑‚ÇÅ^ {1}) (id‚ü∑‚ÇÅ^ {1}))
                    (id‚ü∑‚ÇÅ^ {1}))
                   (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
               (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))
              (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))))))
   (_‚óé^_ {8} {8} {8}
    (‚äï^_ {7} {7}
     (‚äï^_ {6} {6}
      (_‚óé^_ {6} {6} {6}
       (‚äï^_ {5} {5}
        (‚äï^_ {4} {4}
         (_‚óé^_ {4} {4} {4}
          (‚äï^_ {3} {3}
           (‚äï^_ {2} {2}
            (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
             (swap‚Çä^ {0}))))
          (swap‚Çä^ {2}))))
       (swap‚Çä^ {4}))))
    (swap‚Çä^ {6})))))
 (_‚óé^_ {8} {8} {8}
 (_‚óé^_ {8} {8} {8}
  (‚äï^_ {7} {7}
   (‚äï^_ {6} {6}
    (‚äï^_ {5} {5}
     (‚äï^_ {4} {4}
      (_‚óé^_ {4} {4} {4}
       (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
       (_‚óé^_ {4} {4} {4}
        (_‚óé^_ {4} {4} {4}
         (‚äï^_ {3} {3}
          (‚äï^_ {2} {2}
           (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
            (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
             (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
              (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))
         (_‚óé^_ {4} {4} {4}
          (_‚óé^_ {4} {4} {4}
           (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
            (_‚óé^_ {4} {4} {4}
             (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
             (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))))
           (‚äï^_ {3} {3}
            (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
          (_‚óé^_ {4} {4} {4}
           (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
           (_‚óé^_ {4} {4} {4}
            (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
            (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
             (_‚óé^_ {4} {4} {4}
              (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
              (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))))))))
        (_‚óé^_ {4} {4} {4}
         (_‚óé^_ {4} {4} {4}
          (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
          (_‚óé^_ {4} {4} {4}
           (_‚óé^_ {4} {4} {4}
            (_‚óé^_ {4} {4} {4}
             (_‚óé^_ {4} {4} {4}
              (_‚óé^_ {4} {4} {4}
               (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
               (‚äï^_ {3} {3}
                (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
              (_‚óé^_ {4} {4} {4}
               (_‚óé^_ {4} {4} {4}
                (_‚óé^_ {4} {4} {4}
                 (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                 (‚äï^_ {3} {3}
                  (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
                (‚äï^_ {3} {3}
                 (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
               (‚äï^_ {3} {3}
                (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
             (‚äï^_ {3} {3}
              (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
            (‚äï^_ {3} {3}
             (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
           (‚äï^_ {3} {3}
            (‚äï^_ {2} {2}
             (_‚óé^_ {2} {2} {2}
              (_‚óé^_ {2} {2} {2}
               (_‚óé^_ {2} {2} {2}
                (_‚óé^_ {2} {2} {2}
                 (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
                  (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
                 (_‚óé^_ {2} {2} {2}
                  (_‚óé^_ {2} {2} {2}
                   (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
                    (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
                   (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
                  (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
               (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
              (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))
         (‚äï^_ {3} {3}
          (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))))
  (_‚óé^_ {8} {8} {8}
   (_‚óé^_ {8} {8} {8}
    (‚äï^_ {7} {7}
     (‚äï^_ {6} {6}
      (_‚óé^_ {6} {6} {6}
       (‚äï^_ {5} {5}
        (‚äï^_ {4} {4}
         (‚äï^_ {3} {3}
          (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
       (_‚óé^_ {6} {6} {6}
        (_‚óé^_ {6} {6} {6}
         (_‚óé^_ {6} {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))
          (_‚óé^_ {6} {6} {6}
           (‚äï^_ {5} {5}
            (‚äï^_ {4} {4}
             (‚äï^_ {3} {3}
              (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
           (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))
         (‚äï^_ {5} {5}
          (‚äï^_ {4} {4}
           (_‚óé^_ {4} {4} {4}
            (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
             (_‚óé^_ {4} {4} {4}
              (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
              (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))))
            (‚äï^_ {3} {3}
             (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))
        (_‚óé^_ {6} {6} {6}
         (‚äï^_ {5} {5}
          (‚äï^_ {4} {4}
           (‚äï^_ {3} {3}
            (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
         (‚äï^_ {5} {5}
          (‚äï^_ {4} {4}
           (‚äï^_ {3} {3}
            (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))))
    (_‚óé^_ {8} {8} {8}
     (_‚óé^_ {8} {8} {8}
      (_‚óé^_ {8} {8} {8} (‚äï^_ {7} {7} (‚äï^_ {6} {6} (id‚ü∑‚ÇÅ^ {6})))
       (_‚óé^_ {8} {8} {8}
        (‚äï^_ {7} {7}
         (‚äï^_ {6} {6}
          (‚äï^_ {5} {5}
           (‚äï^_ {4} {4}
            (‚äï^_ {3} {3}
             (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))
        (‚äï^_ {7} {7} (‚äï^_ {6} {6} (id‚ü∑‚ÇÅ^ {6})))))
      (‚äï^_ {7} {7}
       (‚äï^_ {6} {6}
        (_‚óé^_ {6} {6} {6}
         (_‚óé^_ {6} {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))
          (_‚óé^_ {6} {6} {6}
           (‚äï^_ {5} {5}
            (‚äï^_ {4} {4}
             (‚äï^_ {3} {3}
              (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
           (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))
         (‚äï^_ {5} {5}
          (‚äï^_ {4} {4}
           (_‚óé^_ {4} {4} {4}
            (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
             (_‚óé^_ {4} {4} {4}
              (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
              (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))))
            (‚äï^_ {3} {3}
             (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))))
     (_‚óé^_ {8} {8} {8}
      (‚äï^_ {7} {7}
       (‚äï^_ {6} {6}
        (‚äï^_ {5} {5}
         (‚äï^_ {4} {4}
          (‚äï^_ {3} {3}
           (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))
      (‚äï^_ {7} {7}
       (‚äï^_ {6} {6}
        (‚äï^_ {5} {5}
         (‚äï^_ {4} {4}
          (_‚óé^_ {4} {4} {4}
           (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
           (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
            (_‚óé^_ {4} {4} {4}
             (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
             (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))))))))))))
   (_‚óé^_ {8} {8} {8}
    (_‚óé^_ {8} {8} {8}
     (‚äï^_ {7} {7}
      (‚äï^_ {6} {6}
       (‚äï^_ {5} {5}
        (‚äï^_ {4} {4}
         (‚äï^_ {3} {3}
          (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))
     (_‚óé^_ {8} {8} {8}
      (_‚óé^_ {8} {8} {8}
       (_‚óé^_ {8} {8} {8}
        (_‚óé^_ {8} {8} {8}
         (_‚óé^_ {8} {8} {8}
          (‚äï^_ {7} {7}
           (‚äï^_ {6} {6}
            (‚äï^_ {5} {5}
             (‚äï^_ {4} {4}
              (‚äï^_ {3} {3}
               (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))
          (‚äï^_ {7} {7}
           (‚äï^_ {6} {6}
            (‚äï^_ {5} {5}
             (‚äï^_ {4} {4}
              (‚äï^_ {3} {3}
               (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))
         (‚äï^_ {7} {7}
          (‚äï^_ {6} {6}
           (_‚óé^_ {6} {6} {6}
            (_‚óé^_ {6} {6} {6}
             (_‚óé^_ {6} {6} {6}
              (‚äï^_ {5} {5}
               (‚äï^_ {4} {4}
                (‚äï^_ {3} {3}
                 (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
              (‚äï^_ {5} {5}
               (‚äï^_ {4} {4}
                (‚äï^_ {3} {3}
                 (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))
             (_‚óé^_ {6} {6} {6}
              (‚äï^_ {5} {5}
               (‚äï^_ {4} {4}
                (‚äï^_ {3} {3}
                 (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
              (_‚óé^_ {6} {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))
               (_‚óé^_ {6} {6} {6}
                (‚äï^_ {5} {5}
                 (‚äï^_ {4} {4}
                  (‚äï^_ {3} {3}
                   (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
                (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))))
            (‚äï^_ {5} {5}
             (‚äï^_ {4} {4}
              (‚äï^_ {3} {3}
               (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))))
        (‚äï^_ {7} {7}
         (‚äï^_ {6} {6}
          (‚äï^_ {5} {5}
           (‚äï^_ {4} {4}
            (‚äï^_ {3} {3}
             (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))
       (‚äï^_ {7} {7}
        (‚äï^_ {6} {6}
         (‚äï^_ {5} {5}
          (‚äï^_ {4} {4}
           (‚äï^_ {3} {3}
            (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))
      (‚äï^_ {7} {7}
       (‚äï^_ {6} {6}
        (‚äï^_ {5} {5}
         (‚äï^_ {4} {4}
          (_‚óé^_ {4} {4} {4}
           (_‚óé^_ {4} {4} {4}
            (_‚óé^_ {4} {4} {4}
             (_‚óé^_ {4} {4} {4}
              (_‚óé^_ {4} {4} {4}
               (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
               (‚äï^_ {3} {3}
                (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
              (‚äï^_ {3} {3}
               (‚äï^_ {2} {2}
                (_‚óé^_ {2} {2} {2}
                 (_‚óé^_ {2} {2} {2}
                  (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
                   (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
                  (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
                 (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
             (‚äï^_ {3} {3}
              (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
            (‚äï^_ {3} {3}
             (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
           (‚äï^_ {3} {3}
            (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))))
    (_‚óé^_ {8} {8} {8}
     (‚äï^_ {7} {7}
      (‚äï^_ {6} {6}
       (‚äï^_ {5} {5}
        (‚äï^_ {4} {4}
         (_‚óé^_ {4} {4} {4}
          (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
          (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
           (_‚óé^_ {4} {4} {4}
            (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
            (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2}))))))))))
     (_‚óé^_ {8} {8} {8} (‚äï^_ {7} {7} (‚äï^_ {6} {6} (id‚ü∑‚ÇÅ^ {6})))
      (_‚óé^_ {8} {8} {8}
       (‚äï^_ {7} {7}
        (‚äï^_ {6} {6}
         (‚äï^_ {5} {5}
          (‚äï^_ {4} {4}
           (‚äï^_ {3} {3}
            (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))
       (‚äï^_ {7} {7} (‚äï^_ {6} {6} (id‚ü∑‚ÇÅ^ {6})))))))))
 (_‚óé^_ {8} {8} {8}
  (_‚óé^_ {8} {8} {8}
   (_‚óé^_ {8} {8} {8}
    (‚äï^_ {7} {7}
     (‚äï^_ {6} {6}
      (_‚óé^_ {6} {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))
       (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))
    (‚äï^_ {7} {7} (‚äï^_ {6} {6} (id‚ü∑‚ÇÅ^ {6}))))
   (‚äï^_ {7} {7}
    (‚äï^_ {6} {6}
     (‚äï^_ {5} {5}
      (‚äï^_ {4} {4}
       (_‚óé^_ {4} {4} {4}
        (_‚óé^_ {4} {4} {4}
         (‚äï^_ {3} {3}
          (‚äï^_ {2} {2}
           (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
            (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
         (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2}))))
        (‚äï^_ {3} {3}
         (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))))
  (_‚óé^_ {8} {8} {8}
   (_‚óé^_ {8} {8} {8}
    (_‚óé^_ {8} {8} {8}
     (‚äï^_ {7} {7} (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))
     (‚äï^_ {7} {7}
      (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))
    (_‚óé^_ {8} {8} {8}
     (_‚óé^_ {8} {8} {8}
      (_‚óé^_ {8} {8} {8}
       (‚äï^_ {7} {7}
        (‚äï^_ {6} {6}
         (‚äï^_ {5} {5}
          (‚äï^_ {4} {4}
           (‚äï^_ {3} {3}
            (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))
       (‚äï^_ {7} {7}
        (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))
      (_‚óé^_ {8} {8} {8}
       (_‚óé^_ {8} {8} {8}
        (‚äï^_ {7} {7} (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))
        (_‚óé^_ {8} {8} {8}
         (_‚óé^_ {8} {8} {8}
          (_‚óé^_ {8} {8} {8}
           (_‚óé^_ {8} {8} {8} (swap‚Çä^ {6})
            (‚äï^_ {7} {7}
             (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))
           (‚äï^_ {7} {7}
            (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))
          (‚äï^_ {7} {7}
           (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))
         (_‚óé^_ {8} {8} {8}
          (‚äï^_ {7} {7} (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))
          (‚äï^_ {7} {7}
           (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))))
       (_‚óé^_ {8} {8} {8}
        (‚äï^_ {7} {7} (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))
        (‚äï^_ {7} {7}
         (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))))
     (_‚óé^_ {8} {8} {8}
      (‚äï^_ {7} {7} (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))
      (‚äï^_ {7} {7}
       (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))))
   (_‚óé^_ {8} {8} {8}
    (_‚óé^_ {8} {8} {8}
     (_‚óé^_ {8} {8} {8}
      (‚äï^_ {7} {7}
       (‚äï^_ {6} {6}
        (‚äï^_ {5} {5}
         (‚äï^_ {4} {4}
          (_‚óé^_ {4} {4} {4}
           (_‚óé^_ {4} {4} {4}
            (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
            (‚äï^_ {3} {3}
             (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
           (_‚óé^_ {4} {4} {4}
            (_‚óé^_ {4} {4} {4}
             (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
             (_‚óé^_ {4} {4} {4}
              (_‚óé^_ {4} {4} {4}
               (_‚óé^_ {4} {4} {4} (swap‚Çä^ {2})
                (‚äï^_ {3} {3}
                 (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
               (‚äï^_ {3} {3}
                (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
              (_‚óé^_ {4} {4} {4}
               (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
               (‚äï^_ {3} {3}
                (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))
            (_‚óé^_ {4} {4} {4}
             (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
             (‚äï^_ {3} {3}
              (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))))
      (‚äï^_ {7} {7}
       (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))
     (_‚óé^_ {8} {8} {8}
      (_‚óé^_ {8} {8} {8}
       (‚äï^_ {7} {7} (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))
       (_‚óé^_ {8} {8} {8}
        (_‚óé^_ {8} {8} {8}
         (_‚óé^_ {8} {8} {8} (swap‚Çä^ {6})
          (‚äï^_ {7} {7}
           (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))
         (‚äï^_ {7} {7}
          (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))
        (_‚óé^_ {8} {8} {8}
         (‚äï^_ {7} {7} (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))
         (‚äï^_ {7} {7}
          (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))))
      (_‚óé^_ {8} {8} {8}
       (‚äï^_ {7} {7} (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))
       (‚äï^_ {7} {7}
        (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))))
    (_‚óé^_ {8} {8} {8}
     (_‚óé^_ {8} {8} {8}
      (‚äï^_ {7} {7}
       (‚äï^_ {6} {6}
        (‚äï^_ {5} {5}
         (‚äï^_ {4} {4}
          (_‚óé^_ {4} {4} {4}
           (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
           (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
            (‚äï^_ {3} {3}
             (‚äï^_ {2} {2}
              (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
               (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))))
      (_‚óé^_ {8} {8} {8} (‚äï^_ {7} {7} (‚äï^_ {6} {6} (id‚ü∑‚ÇÅ^ {6})))
       (‚äï^_ {7} {7}
        (‚äï^_ {6} {6}
         (_‚óé^_ {6} {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))
          (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))))
     (_‚óé^_ {8} {8} {8}
      (_‚óé^_ {8} {8} {8}
       (‚äï^_ {7} {7}
        (‚äï^_ {6} {6}
         (‚äï^_ {5} {5}
          (‚äï^_ {4} {4}
           (_‚óé^_ {4} {4} {4}
            (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
            (_‚óé^_ {4} {4} {4}
             (_‚óé^_ {4} {4} {4}
              (‚äï^_ {3} {3}
               (‚äï^_ {2} {2}
                (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
                 (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
                  (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
                   (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))
              (_‚óé^_ {4} {4} {4}
               (_‚óé^_ {4} {4} {4}
                (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
                 (_‚óé^_ {4} {4} {4}
                  (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                  (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))))
                (‚äï^_ {3} {3}
                 (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
               (_‚óé^_ {4} {4} {4}
                (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                (_‚óé^_ {4} {4} {4}
                 (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                 (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
                  (_‚óé^_ {4} {4} {4}
                   (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                   (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))))))))
             (_‚óé^_ {4} {4} {4}
              (_‚óé^_ {4} {4} {4}
               (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
               (_‚óé^_ {4} {4} {4}
                (_‚óé^_ {4} {4} {4}
                 (_‚óé^_ {4} {4} {4}
                  (_‚óé^_ {4} {4} {4}
                   (_‚óé^_ {4} {4} {4}
                    (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                    (‚äï^_ {3} {3}
                     (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
                   (_‚óé^_ {4} {4} {4}
                    (_‚óé^_ {4} {4} {4}
                     (_‚óé^_ {4} {4} {4}
                      (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                      (‚äï^_ {3} {3}
                       (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
                     (‚äï^_ {3} {3}
                      (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
                    (‚äï^_ {3} {3}
                     (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
                  (‚äï^_ {3} {3}
                   (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
                 (‚äï^_ {3} {3}
                  (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
                (‚äï^_ {3} {3}
                 (‚äï^_ {2} {2}
                  (_‚óé^_ {2} {2} {2}
                   (_‚óé^_ {2} {2} {2}
                    (_‚óé^_ {2} {2} {2}
                     (_‚óé^_ {2} {2} {2}
                      (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
                       (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
                      (_‚óé^_ {2} {2} {2}
                       (_‚óé^_ {2} {2} {2}
                        (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
                         (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
                        (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
                       (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                     (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
                    (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
                   (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))
              (‚äï^_ {3} {3}
               (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))))
       (_‚óé^_ {8} {8} {8}
        (_‚óé^_ {8} {8} {8}
         (‚äï^_ {7} {7}
          (‚äï^_ {6} {6}
           (_‚óé^_ {6} {6} {6}
            (‚äï^_ {5} {5}
             (‚äï^_ {4} {4}
              (‚äï^_ {3} {3}
               (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
            (_‚óé^_ {6} {6} {6}
             (_‚óé^_ {6} {6} {6}
              (_‚óé^_ {6} {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))
               (_‚óé^_ {6} {6} {6}
                (‚äï^_ {5} {5}
                 (‚äï^_ {4} {4}
                  (‚äï^_ {3} {3}
                   (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
                (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))
              (‚äï^_ {5} {5}
               (‚äï^_ {4} {4}
                (_‚óé^_ {4} {4} {4}
                 (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
                  (_‚óé^_ {4} {4} {4}
                   (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                   (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))))
                 (‚äï^_ {3} {3}
                  (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))
             (_‚óé^_ {6} {6} {6}
              (‚äï^_ {5} {5}
               (‚äï^_ {4} {4}
                (‚äï^_ {3} {3}
                 (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
              (‚äï^_ {5} {5}
               (‚äï^_ {4} {4}
                (‚äï^_ {3} {3}
                 (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))))
         (_‚óé^_ {8} {8} {8}
          (_‚óé^_ {8} {8} {8}
           (_‚óé^_ {8} {8} {8} (‚äï^_ {7} {7} (‚äï^_ {6} {6} (id‚ü∑‚ÇÅ^ {6})))
            (_‚óé^_ {8} {8} {8}
             (‚äï^_ {7} {7}
              (‚äï^_ {6} {6}
               (‚äï^_ {5} {5}
                (‚äï^_ {4} {4}
                 (‚äï^_ {3} {3}
                  (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))
             (‚äï^_ {7} {7} (‚äï^_ {6} {6} (id‚ü∑‚ÇÅ^ {6})))))
           (‚äï^_ {7} {7}
            (‚äï^_ {6} {6}
             (_‚óé^_ {6} {6} {6}
              (_‚óé^_ {6} {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))
               (_‚óé^_ {6} {6} {6}
                (‚äï^_ {5} {5}
                 (‚äï^_ {4} {4}
                  (‚äï^_ {3} {3}
                   (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
                (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))
              (‚äï^_ {5} {5}
               (‚äï^_ {4} {4}
                (_‚óé^_ {4} {4} {4}
                 (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
                  (_‚óé^_ {4} {4} {4}
                   (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                   (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))))
                 (‚äï^_ {3} {3}
                  (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))))
          (_‚óé^_ {8} {8} {8}
           (‚äï^_ {7} {7}
            (‚äï^_ {6} {6}
             (‚äï^_ {5} {5}
              (‚äï^_ {4} {4}
               (‚äï^_ {3} {3}
                (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))
           (‚äï^_ {7} {7}
            (‚äï^_ {6} {6}
             (‚äï^_ {5} {5}
              (‚äï^_ {4} {4}
               (_‚óé^_ {4} {4} {4}
                (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
                 (_‚óé^_ {4} {4} {4}
                  (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                  (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))))))))))))
        (_‚óé^_ {8} {8} {8}
         (_‚óé^_ {8} {8} {8}
          (‚äï^_ {7} {7}
           (‚äï^_ {6} {6}
            (‚äï^_ {5} {5}
             (‚äï^_ {4} {4}
              (‚äï^_ {3} {3}
               (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))
          (_‚óé^_ {8} {8} {8}
           (_‚óé^_ {8} {8} {8}
            (_‚óé^_ {8} {8} {8}
             (_‚óé^_ {8} {8} {8}
              (_‚óé^_ {8} {8} {8}
               (‚äï^_ {7} {7}
                (‚äï^_ {6} {6}
                 (‚äï^_ {5} {5}
                  (‚äï^_ {4} {4}
                   (‚äï^_ {3} {3}
                    (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))
               (‚äï^_ {7} {7}
                (‚äï^_ {6} {6}
                 (‚äï^_ {5} {5}
                  (‚äï^_ {4} {4}
                   (‚äï^_ {3} {3}
                    (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))
              (‚äï^_ {7} {7}
               (‚äï^_ {6} {6}
                (_‚óé^_ {6} {6} {6}
                 (_‚óé^_ {6} {6} {6}
                  (_‚óé^_ {6} {6} {6}
                   (‚äï^_ {5} {5}
                    (‚äï^_ {4} {4}
                     (‚äï^_ {3} {3}
                      (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
                   (‚äï^_ {5} {5}
                    (‚äï^_ {4} {4}
                     (‚äï^_ {3} {3}
                      (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))
                  (_‚óé^_ {6} {6} {6}
                   (‚äï^_ {5} {5}
                    (‚äï^_ {4} {4}
                     (‚äï^_ {3} {3}
                      (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
                   (_‚óé^_ {6} {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))
                    (_‚óé^_ {6} {6} {6}
                     (‚äï^_ {5} {5}
                      (‚äï^_ {4} {4}
                       (‚äï^_ {3} {3}
                        (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
                     (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))))
                 (‚äï^_ {5} {5}
                  (‚äï^_ {4} {4}
                   (‚äï^_ {3} {3}
                    (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))))
             (‚äï^_ {7} {7}
              (‚äï^_ {6} {6}
               (‚äï^_ {5} {5}
                (‚äï^_ {4} {4}
                 (‚äï^_ {3} {3}
                  (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))
            (‚äï^_ {7} {7}
             (‚äï^_ {6} {6}
              (‚äï^_ {5} {5}
               (‚äï^_ {4} {4}
                (‚äï^_ {3} {3}
                 (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))
           (‚äï^_ {7} {7}
            (‚äï^_ {6} {6}
             (‚äï^_ {5} {5}
              (‚äï^_ {4} {4}
               (_‚óé^_ {4} {4} {4}
                (_‚óé^_ {4} {4} {4}
                 (_‚óé^_ {4} {4} {4}
                  (_‚óé^_ {4} {4} {4}
                   (_‚óé^_ {4} {4} {4}
                    (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                    (‚äï^_ {3} {3}
                     (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
                   (‚äï^_ {3} {3}
                    (‚äï^_ {2} {2}
                     (_‚óé^_ {2} {2} {2}
                      (_‚óé^_ {2} {2} {2}
                       (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
                        (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
                       (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
                      (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
                  (‚äï^_ {3} {3}
                   (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
                 (‚äï^_ {3} {3}
                  (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
                (‚äï^_ {3} {3}
                 (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))))
         (_‚óé^_ {8} {8} {8}
          (‚äï^_ {7} {7}
           (‚äï^_ {6} {6}
            (‚äï^_ {5} {5}
             (‚äï^_ {4} {4}
              (_‚óé^_ {4} {4} {4}
               (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
               (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
                (_‚óé^_ {4} {4} {4}
                 (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                 (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2}))))))))))
          (_‚óé^_ {8} {8} {8} (‚äï^_ {7} {7} (‚äï^_ {6} {6} (id‚ü∑‚ÇÅ^ {6})))
           (_‚óé^_ {8} {8} {8}
            (‚äï^_ {7} {7}
             (‚äï^_ {6} {6}
              (‚äï^_ {5} {5}
               (‚äï^_ {4} {4}
                (‚äï^_ {3} {3}
                 (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))
            (‚äï^_ {7} {7} (‚äï^_ {6} {6} (id‚ü∑‚ÇÅ^ {6})))))))))
      (_‚óé^_ {8} {8} {8}
       (_‚óé^_ {8} {8} {8}
        (_‚óé^_ {8} {8} {8}
         (‚äï^_ {7} {7}
          (‚äï^_ {6} {6}
           (_‚óé^_ {6} {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))
            (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))
         (‚äï^_ {7} {7} (‚äï^_ {6} {6} (id‚ü∑‚ÇÅ^ {6}))))
        (‚äï^_ {7} {7}
         (‚äï^_ {6} {6}
          (‚äï^_ {5} {5}
           (‚äï^_ {4} {4}
            (_‚óé^_ {4} {4} {4}
             (_‚óé^_ {4} {4} {4}
              (‚äï^_ {3} {3}
               (‚äï^_ {2} {2}
                (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
                 (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
              (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2}))))
             (‚äï^_ {3} {3}
              (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))))
       (_‚óé^_ {8} {8} {8}
        (_‚óé^_ {8} {8} {8}
         (_‚óé^_ {8} {8} {8}
          (‚äï^_ {7} {7}
           (‚äï^_ {6} {6}
            (‚äï^_ {5} {5}
             (‚äï^_ {4} {4}
              (_‚óé^_ {4} {4} {4}
               (_‚óé^_ {4} {4} {4}
                (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                (‚äï^_ {3} {3}
                 (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
               (_‚óé^_ {4} {4} {4}
                (_‚óé^_ {4} {4} {4}
                 (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                 (_‚óé^_ {4} {4} {4}
                  (_‚óé^_ {4} {4} {4}
                   (_‚óé^_ {4} {4} {4} (swap‚Çä^ {2})
                    (‚äï^_ {3} {3}
                     (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
                   (‚äï^_ {3} {3}
                    (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
                  (_‚óé^_ {4} {4} {4}
                   (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                   (‚äï^_ {3} {3}
                    (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))
                (_‚óé^_ {4} {4} {4}
                 (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                 (‚äï^_ {3} {3}
                  (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))))
          (‚äï^_ {7} {7}
           (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))
         (_‚óé^_ {8} {8} {8}
          (_‚óé^_ {8} {8} {8}
           (‚äï^_ {7} {7} (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))
           (_‚óé^_ {8} {8} {8}
            (_‚óé^_ {8} {8} {8}
             (_‚óé^_ {8} {8} {8} (swap‚Çä^ {6})
              (‚äï^_ {7} {7}
               (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))
             (‚äï^_ {7} {7}
              (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))
            (_‚óé^_ {8} {8} {8}
             (‚äï^_ {7} {7} (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))
             (‚äï^_ {7} {7}
              (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))))
          (_‚óé^_ {8} {8} {8}
           (‚äï^_ {7} {7} (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))
           (‚äï^_ {7} {7}
            (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))))
        (_‚óé^_ {8} {8} {8}
         (_‚óé^_ {8} {8} {8}
          (‚äï^_ {7} {7}
           (‚äï^_ {6} {6}
            (‚äï^_ {5} {5}
             (‚äï^_ {4} {4}
              (_‚óé^_ {4} {4} {4}
               (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
               (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
                (‚äï^_ {3} {3}
                 (‚äï^_ {2} {2}
                  (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
                   (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))))
          (_‚óé^_ {8} {8} {8} (‚äï^_ {7} {7} (‚äï^_ {6} {6} (id‚ü∑‚ÇÅ^ {6})))
           (‚äï^_ {7} {7}
            (‚äï^_ {6} {6}
             (_‚óé^_ {6} {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))
              (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))))
         (_‚óé^_ {8} {8} {8}
          (‚äï^_ {7} {7}
           (‚äï^_ {6} {6}
            (_‚óé^_ {6} {6} {6}
             (‚äï^_ {5} {5}
              (‚äï^_ {4} {4}
               (_‚óé^_ {4} {4} {4}
                (‚äï^_ {3} {3}
                 (‚äï^_ {2} {2}
                  (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
                   (_‚óé^_ {2} {2} {2}
                    (_‚óé^_ {2} {2} {2}
                     (‚äï^_ {1} {1}
                      (_‚óé^_ {1} {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))
                       (_‚óé^_ {1} {1} {1} (id‚ü∑‚ÇÅ^ {1})
                        (_‚óé^_ {1} {1} {1} (id‚ü∑‚ÇÅ^ {1}) (id‚ü∑‚ÇÅ^ {1})))))
                     (_‚óé^_ {2} {2} {2}
                      (_‚óé^_ {2} {2} {2} (swap‚Çä^ {0}) (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))
                      (_‚óé^_ {2} {2} {2} (id‚ü∑‚ÇÅ^ {2})
                       (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})) (swap‚Çä^ {0})))))
                    (_‚óé^_ {2} {2} {2}
                     (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
                      (_‚óé^_ {2} {2} {2}
                       (_‚óé^_ {2} {2} {2}
                        (_‚óé^_ {2} {2} {2}
                         (_‚óé^_ {2} {2} {2} (_‚óé^_ {2} {2} {2} (id‚ü∑‚ÇÅ^ {2}) (id‚ü∑‚ÇÅ^ {2}))
                          (_‚óé^_ {2} {2} {2}
                           (_‚óé^_ {2} {2} {2} (_‚óé^_ {2} {2} {2} (id‚ü∑‚ÇÅ^ {2}) (id‚ü∑‚ÇÅ^ {2}))
                            (id‚ü∑‚ÇÅ^ {2}))
                           (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1}))))
                         (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))
                        (id‚ü∑‚ÇÅ^ {2}))
                       (‚äï^_ {1} {1}
                        (_‚óé^_ {1} {1} {1}
                         (_‚óé^_ {1} {1} {1}
                          (_‚óé^_ {1} {1} {1}
                           (_‚óé^_ {1} {1} {1} (_‚óé^_ {1} {1} {1} (id‚ü∑‚ÇÅ^ {1}) (id‚ü∑‚ÇÅ^ {1}))
                            (_‚óé^_ {1} {1} {1}
                             (_‚óé^_ {1} {1} {1} (_‚óé^_ {1} {1} {1} (id‚ü∑‚ÇÅ^ {1}) (id‚ü∑‚ÇÅ^ {1}))
                              (id‚ü∑‚ÇÅ^ {1}))
                             (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
                           (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
                          (id‚ü∑‚ÇÅ^ {1}))
                         (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
                     (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))
                (_‚óé^_ {4} {4} {4}
                 (_‚óé^_ {4} {4} {4}
                  (‚äï^_ {3} {3}
                   (_‚óé^_ {3} {3} {3}
                    (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
                    (_‚óé^_ {3} {3} {3}
                     (_‚óé^_ {3} {3} {3} (swap‚Çä^ {1})
                      (‚äï^_ {2} {2}
                       (_‚óé^_ {2} {2} {2} (swap‚Çä^ {0}) (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))
                     (_‚óé^_ {3} {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))
                      (‚äï^_ {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))))
                  (_‚óé^_ {4} {4} {4}
                   (_‚óé^_ {4} {4} {4} (swap‚Çä^ {2})
                    (‚äï^_ {3} {3}
                     (_‚óé^_ {3} {3} {3} (swap‚Çä^ {1})
                      (‚äï^_ {2} {2}
                       (_‚óé^_ {2} {2} {2} (swap‚Çä^ {0}) (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))))
                   (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
                    (‚äï^_ {3} {3}
                     (‚äï^_ {2} {2}
                      (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})) (swap‚Çä^ {0})))))))
                 (_‚óé^_ {4} {4} {4}
                  (_‚óé^_ {4} {4} {4}
                   (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                   (_‚óé^_ {4} {4} {4}
                    (_‚óé^_ {4} {4} {4}
                     (_‚óé^_ {4} {4} {4}
                      (_‚óé^_ {4} {4} {4}
                       (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (id‚ü∑‚ÇÅ^ {3}))
                        (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2}))))
                       (‚äï^_ {3} {3}
                        (_‚óé^_ {3} {3} {3}
                         (_‚óé^_ {3} {3} {3}
                          (_‚óé^_ {3} {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2}))
                           (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
                          (_‚óé^_ {3} {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})) (swap‚Çä^ {1})))
                         (‚äï^_ {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1}))))))
                      (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2}))))
                     (‚äï^_ {3} {3} (id‚ü∑‚ÇÅ^ {3})))
                    (‚äï^_ {3} {3}
                     (‚äï^_ {2} {2}
                      (_‚óé^_ {2} {2} {2}
                       (_‚óé^_ {2} {2} {2}
                        (_‚óé^_ {2} {2} {2}
                         (_‚óé^_ {2} {2} {2}
                          (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1}))
                           (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))
                          (‚äï^_ {1} {1}
                           (_‚óé^_ {1} {1} {1}
                            (_‚óé^_ {1} {1} {1} (_‚óé^_ {1} {1} {1} (id‚ü∑‚ÇÅ^ {1}) (id‚ü∑‚ÇÅ^ {1}))
                             (id‚ü∑‚ÇÅ^ {1}))
                            (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                         (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))
                        (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))
                       (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))
                  (_‚óé^_ {4} {4} {4}
                   (‚äï^_ {3} {3}
                    (‚äï^_ {2} {2}
                     (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
                      (swap‚Çä^ {0}))))
                   (swap‚Çä^ {2})))))))
             (_‚óé^_ {6} {6} {6}
              (_‚óé^_ {6} {6} {6}
               (‚äï^_ {5} {5}
                (_‚óé^_ {5} {5} {5}
                 (‚äï^_ {4} {4}
                  (‚äï^_ {3} {3}
                   (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
                 (_‚óé^_ {5} {5} {5}
                  (_‚óé^_ {5} {5} {5} (swap‚Çä^ {3})
                   (‚äï^_ {4} {4}
                    (_‚óé^_ {4} {4} {4} (swap‚Çä^ {2})
                     (‚äï^_ {3} {3}
                      (_‚óé^_ {3} {3} {3} (swap‚Çä^ {1})
                       (‚äï^_ {2} {2}
                        (_‚óé^_ {2} {2} {2} (swap‚Çä^ {0}) (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))))))
                  (_‚óé^_ {5} {5} {5}
                   (‚äï^_ {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))
                   (‚äï^_ {4} {4}
                    (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))))))
               (_‚óé^_ {6} {6} {6}
                (_‚óé^_ {6} {6} {6} (swap‚Çä^ {4})
                 (‚äï^_ {5} {5}
                  (_‚óé^_ {5} {5} {5} (swap‚Çä^ {3})
                   (‚äï^_ {4} {4}
                    (_‚óé^_ {4} {4} {4} (swap‚Çä^ {2})
                     (‚äï^_ {3} {3}
                      (_‚óé^_ {3} {3} {3} (swap‚Çä^ {1})
                       (‚äï^_ {2} {2}
                        (_‚óé^_ {2} {2} {2} (swap‚Çä^ {0}) (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))))))))
                (_‚óé^_ {6} {6} {6}
                 (‚äï^_ {5} {5} (‚äï^_ {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))))
                 (‚äï^_ {5} {5}
                  (‚äï^_ {4} {4}
                   (‚äï^_ {3} {3}
                    (‚äï^_ {2} {2}
                     (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})) (swap‚Çä^ {0})))))))))
              (_‚óé^_ {6} {6} {6}
               (_‚óé^_ {6} {6} {6}
                (‚äï^_ {5} {5}
                 (‚äï^_ {4} {4}
                  (‚äï^_ {3} {3}
                   (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
                (_‚óé^_ {6} {6} {6}
                 (_‚óé^_ {6} {6} {6}
                  (_‚óé^_ {6} {6} {6}
                   (_‚óé^_ {6} {6} {6}
                    (_‚óé^_ {6} {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))
                     (‚äï^_ {5} {5}
                      (‚äï^_ {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2}))))))
                    (‚äï^_ {5} {5}
                     (‚äï^_ {4} {4}
                      (_‚óé^_ {4} {4} {4}
                       (_‚óé^_ {4} {4} {4}
                        (_‚óé^_ {4} {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))
                         (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2}))))
                        (_‚óé^_ {4} {4} {4}
                         (‚äï^_ {3} {3}
                          (_‚óé^_ {3} {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})) (swap‚Çä^ {1})))
                         (swap‚Çä^ {2})))
                       (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1}))))))))
                   (‚äï^_ {5} {5} (‚äï^_ {4} {4} (‚äï^_ {3} {3} (id‚ü∑‚ÇÅ^ {3})))))
                  (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))
                 (‚äï^_ {5} {5}
                  (‚äï^_ {4} {4}
                   (‚äï^_ {3} {3}
                    (_‚óé^_ {3} {3} {3}
                     (_‚óé^_ {3} {3} {3}
                      (_‚óé^_ {3} {3} {3}
                       (_‚óé^_ {3} {3} {3}
                        (_‚óé^_ {3} {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))
                         (‚äï^_ {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1}))))
                        (‚äï^_ {2} {2}
                         (‚äï^_ {1} {1}
                          (_‚óé^_ {1} {1} {1}
                           (_‚óé^_ {1} {1} {1} (_‚óé^_ {1} {1} {1} (id‚ü∑‚ÇÅ^ {1}) (id‚ü∑‚ÇÅ^ {1}))
                            (id‚ü∑‚ÇÅ^ {1}))
                           (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
                       (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))
                      (‚äï^_ {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1}))))
                     (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))
               (_‚óé^_ {6} {6} {6}
                (‚äï^_ {5} {5}
                 (_‚óé^_ {5} {5} {5}
                  (‚äï^_ {4} {4}
                   (‚äï^_ {3} {3}
                    (_‚óé^_ {3} {3} {3}
                     (‚äï^_ {2} {2}
                      (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
                       (swap‚Çä^ {0})))
                     (_‚óé^_ {3} {3} {3} (swap‚Çä^ {1})
                      (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))
                  (swap‚Çä^ {3})))
                (_‚óé^_ {6} {6} {6} (swap‚Çä^ {4})
                 (‚äï^_ {5} {5} (‚äï^_ {4} {4} (‚äï^_ {3} {3} (id‚ü∑‚ÇÅ^ {3})))))))))))
          (_‚óé^_ {8} {8} {8}
           (_‚óé^_ {8} {8} {8}
            (‚äï^_ {7} {7}
             (_‚óé^_ {7} {7} {7}
              (‚äï^_ {6} {6}
               (‚äï^_ {5} {5}
                (‚äï^_ {4} {4}
                 (‚äï^_ {3} {3}
                  (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))
              (_‚óé^_ {7} {7} {7}
               (_‚óé^_ {7} {7} {7} (swap‚Çä^ {5})
                (‚äï^_ {6} {6}
                 (_‚óé^_ {6} {6} {6} (swap‚Çä^ {4})
                  (‚äï^_ {5} {5}
                   (_‚óé^_ {5} {5} {5} (swap‚Çä^ {3})
                    (‚äï^_ {4} {4}
                     (_‚óé^_ {4} {4} {4} (swap‚Çä^ {2})
                      (‚äï^_ {3} {3}
                       (_‚óé^_ {3} {3} {3} (swap‚Çä^ {1})
                        (‚äï^_ {2} {2}
                         (_‚óé^_ {2} {2} {2} (swap‚Çä^ {0}) (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))))))))))
               (_‚óé^_ {7} {7} {7}
                (‚äï^_ {6} {6}
                 (‚äï^_ {5} {5}
                  (‚äï^_ {4} {4}
                   (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))))
                (‚äï^_ {6} {6}
                 (‚äï^_ {5} {5}
                  (‚äï^_ {4} {4}
                   (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))))))))
            (_‚óé^_ {8} {8} {8}
             (_‚óé^_ {8} {8} {8} (swap‚Çä^ {6})
              (‚äï^_ {7} {7}
               (_‚óé^_ {7} {7} {7} (swap‚Çä^ {5})
                (‚äï^_ {6} {6}
                 (_‚óé^_ {6} {6} {6} (swap‚Çä^ {4})
                  (‚äï^_ {5} {5}
                   (_‚óé^_ {5} {5} {5} (swap‚Çä^ {3})
                    (‚äï^_ {4} {4}
                     (_‚óé^_ {4} {4} {4} (swap‚Çä^ {2})
                      (‚äï^_ {3} {3}
                       (_‚óé^_ {3} {3} {3} (swap‚Çä^ {1})
                        (‚äï^_ {2} {2}
                         (_‚óé^_ {2} {2} {2} (swap‚Çä^ {0})
                          (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))))))))))))
             (_‚óé^_ {8} {8} {8}
              (‚äï^_ {7} {7}
               (‚äï^_ {6} {6}
                (‚äï^_ {5} {5}
                 (‚äï^_ {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))))))
              (‚äï^_ {7} {7}
               (‚äï^_ {6} {6}
                (‚äï^_ {5} {5}
                 (‚äï^_ {4} {4}
                  (‚äï^_ {3} {3}
                   (‚äï^_ {2} {2}
                    (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})) (swap‚Çä^ {0})))))))))))
           (_‚óé^_ {8} {8} {8}
            (_‚óé^_ {8} {8} {8}
             (‚äï^_ {7} {7}
              (‚äï^_ {6} {6}
               (‚äï^_ {5} {5}
                (‚äï^_ {4} {4}
                 (‚äï^_ {3} {3}
                  (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))
             (_‚óé^_ {8} {8} {8}
              (_‚óé^_ {8} {8} {8}
               (_‚óé^_ {8} {8} {8}
                (_‚óé^_ {8} {8} {8}
                 (_‚óé^_ {8} {8} {8}
                  (‚äï^_ {7} {7} (‚äï^_ {6} {6} (‚äï^_ {5} {5} (id‚ü∑‚ÇÅ^ {5}))))
                  (‚äï^_ {7} {7}
                   (‚äï^_ {6} {6}
                    (‚äï^_ {5} {5}
                     (‚äï^_ {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2}))))))))
                 (‚äï^_ {7} {7}
                  (‚äï^_ {6} {6}
                   (‚äï^_ {5} {5}
                    (_‚óé^_ {5} {5} {5}
                     (_‚óé^_ {5} {5} {5}
                      (_‚óé^_ {5} {5} {5}
                       (‚äï^_ {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2}))))
                       (‚äï^_ {4} {4} (‚äï^_ {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})))))
                      (_‚óé^_ {5} {5} {5}
                       (‚äï^_ {4} {4}
                        (_‚óé^_ {4} {4} {4}
                         (‚äï^_ {3} {3}
                          (_‚óé^_ {3} {3} {3} (‚äï^_ {2} {2} (id‚ü∑‚ÇÅ^ {2})) (swap‚Çä^ {1})))
                         (swap‚Çä^ {2})))
                       (swap‚Çä^ {3})))
                     (‚äï^_ {4} {4}
                      (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1}))))))))))
                (‚äï^_ {7} {7}
                 (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4}))))))
               (‚äï^_ {7} {7} (‚äï^_ {6} {6} (‚äï^_ {5} {5} (id‚ü∑‚ÇÅ^ {5})))))
              (‚äï^_ {7} {7}
               (‚äï^_ {6} {6}
                (‚äï^_ {5} {5}
                 (‚äï^_ {4} {4}
                  (_‚óé^_ {4} {4} {4}
                   (_‚óé^_ {4} {4} {4}
                    (_‚óé^_ {4} {4} {4}
                     (_‚óé^_ {4} {4} {4}
                      (_‚óé^_ {4} {4} {4}
                       (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1}))))
                       (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))
                      (‚äï^_ {3} {3}
                       (‚äï^_ {2} {2}
                        (‚äï^_ {1} {1}
                         (_‚óé^_ {1} {1} {1}
                          (_‚óé^_ {1} {1} {1} (_‚óé^_ {1} {1} {1} (id‚ü∑‚ÇÅ^ {1}) (id‚ü∑‚ÇÅ^ {1}))
                           (id‚ü∑‚ÇÅ^ {1}))
                          (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
                     (‚äï^_ {3} {3}
                      (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))
                    (‚äï^_ {3} {3} (‚äï^_ {2} {2} (‚äï^_ {1} {1} (id‚ü∑‚ÇÅ^ {1})))))
                   (‚äï^_ {3} {3}
                    (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0}))))))))))))
            (_‚óé^_ {8} {8} {8}
             (‚äï^_ {7} {7}
              (_‚óé^_ {7} {7} {7}
               (‚äï^_ {6} {6}
                (_‚óé^_ {6} {6} {6}
                 (‚äï^_ {5} {5}
                  (‚äï^_ {4} {4}
                   (_‚óé^_ {4} {4} {4}
                    (‚äï^_ {3} {3}
                     (_‚óé^_ {3} {3} {3}
                      (‚äï^_ {2} {2}
                       (_‚óé^_ {2} {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))
                        (swap‚Çä^ {0})))
                      (_‚óé^_ {3} {3} {3} (swap‚Çä^ {1})
                       (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))
                    (_‚óé^_ {4} {4} {4} (swap‚Çä^ {2})
                     (‚äï^_ {3} {3}
                      (‚äï^_ {2} {2} (‚äï^_ {1} {1} (‚äï^_ {0} {0} (id‚ü∑‚ÇÅ^ {0})))))))))
                 (swap‚Çä^ {4})))
               (_‚óé^_ {7} {7} {7} (swap‚Çä^ {5})
                (‚äï^_ {6} {6} (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))))
             (_‚óé^_ {8} {8} {8} (swap‚Çä^ {6})
              (‚äï^_ {7} {7}
               (‚äï^_ {6} {6}
                (‚äï^_ {5} {5} (‚äï^_ {4} {4} (id‚ü∑‚ÇÅ^ {4})))))))))))))))))))

-- y = Pi^.evalNorm‚ÇÅ x


-- z = Pi^.quoteNorm‚ÇÅ idp y


-- w = Pi^.quote^‚ÇÅ z

{--

adder+ : Pi^.quote^‚ÇÄ 16 Pi+.‚ü∑‚ÇÅ Pi^.quote^‚ÇÄ 16
adder+ = (Pi^.quote^‚ÇÅ ‚àò Pi^.quoteNorm‚ÇÅ idp ‚àò Pi^.evalNorm‚ÇÅ ‚àò eval‚ÇÅ) adder

-- reset+test : Fin 4 ‚Üí Fin 4
-- reset+test = ‚Äì> (Pi+.eval‚ÇÅ (reset+ 1))

-- reset+test-0 : reset+test 0 == 0 -- 00 -> 00
-- reset+test-0 = fin= idp

-- reset+test-1 : reset+test 1 == 3 -- 10 -> 11
-- reset+test-1 = fin= idp

-- reset+test-2 : reset+test 2 == 2 -- 01 -> 01
-- reset+test-2 = fin= idp

-- reset+test-3 : reset+test 3 == 1 -- 11 -> 10
-- reset+test-3 = fin= idp

reset+test : Fin 16 ‚Üí Fin 16
reset+test = ‚Äì> (Pi+.eval‚ÇÅ (reset+ 3))

reset-test : Fin 16 ‚Üí Fin 16
reset-test = ‚Äì> (Pi^.evalNorm‚ÇÅ (eval‚ÇÅ (reset 3)))

--}

-- 0 b1 b2 b3 => or(b1,b2,b3) , b1 b2 b3
-- 1 b1 b2 b3 => nor(b1,b2,b3) , b1 b2 b3

-- {-

-- 0000 -> 0000 -> 0 -> 0
-- 0001 -> 1001 -> 1 -> 9
-- 0010 -> 1010 -> 2 -> 10
-- 0011 -> 1011 -> 3 -> 11
-- 0100 -> 1100 -> 4 -> 12
-- 0101 -> 1101 -> 5 -> 13
-- 0110 -> 1110 -> 6 -> 14
-- 0111 -> 1111 -> 7 -> 15
-- 1000 -> 1000 -> 8 -> 8
-- 1001 -> 0001 -> 9 -> 1
-- 1010 -> 0010 -> 10 -> 2
-- 1011 -> 0011 -> 11 -> 3
-- 1100 -> 0100 -> 12 -> 4
-- 1101 -> 0101 -> 13 -> 5
-- 1110 -> 0110 -> 14 -> 6
-- 1111 -> 0111 -> 15 -> 7

-- -}

{--

_ : reset-test 5 == 5
_ = fin= idp

reset+test-0 : reset+test 0 == 0 -- 0000 -> 0000
reset+test-0 = fin= idp

reset+test-1 : reset+test 1 == 3 -- 1000 -> 1001
reset+test-1 = fin= idp

reset+test-2 : reset+test 2 == 2 -- 0100 -> 0100
reset+test-2 = fin= idp

reset+test-3 : reset+test 3 == 1 -- 1001 -> 1000
reset+test-3 = fin= idp

reset+test-4 : reset+test 4 == 4
reset+test-4 = fin= idp

reset+test-5 : reset+test 5 == 5
reset+test-5 = fin= idp

reset+test-6 : reset+test 6 == 6
reset+test-6 = fin= idp

reset+test-7 : reset+test 7 == 7
reset+test-7 = fin= idp

reset+test-8 : reset+test 8 == 8
reset+test-8 = fin= idp

reset+test-9 : reset+test 9 == 9
reset+test-9 = fin= idp

reset+test-n : reset+test 12 == 12
reset+test-n = fin= idp

fst2last : ‚àÄ n ‚Üí ùîπ n Pi.‚ü∑‚ÇÅ ùîπ n
fst2last O = id‚ü∑‚ÇÅ
fst2last (S O) = id‚ü∑‚ÇÅ
fst2last (S (S O)) = swap‚ãÜ
fst2last (S (S (S n))) = rearrange ùüö ùüö (ùîπ (S n)) ‚óé (id‚ü∑‚ÇÅ ‚äó fst2last (S (S n)))

incr : ‚àÄ n ‚Üí ùîπ n Pi.‚ü∑‚ÇÅ ùîπ n
incr O = id‚ü∑‚ÇÅ
incr (S O) = swap‚Çä
incr (S (S n)) = (id‚ü∑‚ÇÅ ‚äó incr (S n)) ‚óé fst2last (S (S n)) ‚óé toffoli (S (S n)) ‚óé Pi.!‚ü∑‚ÇÅ (fst2last (S (S n)))

incr^ : ‚àÄ n ‚Üí _
incr^ = eval‚ÇÅ ‚àò incr

incr+ : ‚àÄ n ‚Üí _
incr+ = Pi^.quote^‚ÇÅ ‚àò Pi^.quoteNorm‚ÇÅ idp ‚àò Pi^.evalNorm‚ÇÅ ‚àò incr^

incr+test : Fin 4 ‚Üí Fin 4
incr+test = ‚Äì> (Pi+.eval‚ÇÅ (incr+ 2))

incr+test-0 : incr+test 0 == 3
incr+test-0 = fin= idp

incr+test-1 : incr+test 1 == 0
incr+test-1 = fin= idp

incr+test-2 : incr+test 2 == 1
incr+test-2 = fin= idp

incr+test-3 : incr+test 3 == 2
incr+test-3 = fin= idp

--}
